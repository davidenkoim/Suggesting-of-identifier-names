// Path id: 27
// Path to file: C:\Users\Igor\IdeaProjects\SLP-Core-0.3\java-projects\cassandra-trunk\src\java\org\apache\cassandra\auth\CassandraAuthorizer.java
// Number of identifiers: 319	Accuracy: 38.24%	MRR: 47.33%
// True 	Rank of true in predictions : [(predicted token, probability of a token), ...]

/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.cassandra.auth;
// cassandra            0	: [('cassandra', 0.9348837607885364), ('commons', 0.0054380985806726755), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]

import java.util.*;

import com.google.common.collect.ImmutableSet;
import com.google.common.collect.Iterables;
import com.google.common.collect.Lists;
import org.apache.commons.lang3.StringUtils;
// commons              1	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import org.apache.cassandra.config.DatabaseDescriptor;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// config               5	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
import org.apache.cassandra.cql3.*;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// cql3                 2	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
import org.apache.cassandra.cql3.statements.BatchStatement;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// cql3                 2	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
// statements           0	: [('statements', 0.17889879280394377), ('functions', 0.17741447552653514), ('validation', 0.052924787362030094), ('selection', 0.0365310438331495), ('restrictions', 0.029821337043708703), ('conditions', 0.011927668651832762), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
import org.apache.cassandra.cql3.statements.ModificationStatement;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// cql3                 2	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
// statements           0	: [('statements', 0.17889879280394377), ('functions', 0.17741447552653514), ('validation', 0.052924787362030094), ('selection', 0.0365310438331495), ('restrictions', 0.029821337043708703), ('conditions', 0.011927668651832762), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
import org.apache.cassandra.cql3.statements.SelectStatement;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// cql3                 2	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
// statements           0	: [('statements', 0.17889879280394377), ('functions', 0.17741447552653514), ('validation', 0.052924787362030094), ('selection', 0.0365310438331495), ('restrictions', 0.029821337043708703), ('conditions', 0.011927668651832762), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
import org.apache.cassandra.db.ConsistencyLevel;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// db                   0	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
import org.apache.cassandra.db.marshal.UTF8Type;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// db                   0	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
import org.apache.cassandra.exceptions.*;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// exceptions           6	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
import org.apache.cassandra.schema.SchemaConstants;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// schema               3	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
import org.apache.cassandra.service.ClientState;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// service              4	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
import org.apache.cassandra.service.QueryState;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// service              4	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
import org.apache.cassandra.transport.messages.ResultMessage;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// transport            7	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]
// messages             0	: [('messages', 0.20890503166115093), ('frame', 0.09425306436847387), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123)]
import org.apache.cassandra.utils.ByteBufferUtil;
// cassandra            0	: [('cassandra', 0.9279916931682504), ('commons', 0.012330166200958762), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// utils                1	: [('db', 0.20315428964762056), ('utils', 0.10122860677667724), ('cql3', 0.07284989144218054), ('schema', 0.06442350639749277), ('service', 0.032104097289638034), ('config', 0.030371273011993986), ('exceptions', 0.03026817268169018), ('transport', 0.02356684132255849), ('index', 0.022610252646739545), ('stress', 0.01743344609624035)]

/**
 * CassandraAuthorizer is an IAuthorizer implementation that keeps
 * user permissions internally in C* using the system_auth.role_permissions
 * table.
 */
public class CassandraAuthorizer implements IAuthorizer
{
    private static final Logger logger = LoggerFactory.getLogger(CassandraAuthorizer.class);
// logger               0	: [('logger', 0.9639892189462367), ('log', 0.003478850898943476), ('wrapped', 0.0003389015491028317), ('logBackLogger', 0.00024077689238720414), ('logbackLogger', 0.00016062421710632088), ('l', 8.340796014680867e-05), ('mock', 8.069992991709983e-05), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05)]

    private static final String ROLE = "role";
// ROLE                 No	: [('KEYSPACE1', 0.034132550207441686), ('CF_STANDARD1', 0.03409566534494631), ('KEYSPACE', 0.024089324466639448), ('TABLE', 0.022309748909958464), ('CF', 0.014440291838349863), ('CF_STANDARD2', 0.010535003620752105), ('KEYSPACE2', 0.010232464489140117), ('HELP_OPTION', 0.009475411104041261), ('DEFAULT_DC', 0.009324039579265775), ('DEFAULT_RACK', 0.009324039579265775)]
    private static final String RESOURCE = "resource";
// RESOURCE             No	: [('KEYSPACE1', 0.034132550207441686), ('CF_STANDARD1', 0.03409566534494631), ('KEYSPACE', 0.024089324466639448), ('TABLE', 0.022309748909958464), ('CF', 0.014440291838349863), ('CF_STANDARD2', 0.010535003620752105), ('KEYSPACE2', 0.010232464489140117), ('HELP_OPTION', 0.009475411104041261), ('DEFAULT_DC', 0.009324039579265775), ('DEFAULT_RACK', 0.009324039579265775)]
    private static final String PERMISSIONS = "permissions";
// PERMISSIONS          No	: [('KEYSPACE1', 0.034132550207441686), ('CF_STANDARD1', 0.03409566534494631), ('KEYSPACE', 0.024089324466639448), ('TABLE', 0.022309748909958464), ('CF', 0.014440291838349863), ('CF_STANDARD2', 0.010535003620752105), ('KEYSPACE2', 0.010232464489140117), ('HELP_OPTION', 0.009475411104041261), ('DEFAULT_DC', 0.009324039579265775), ('DEFAULT_RACK', 0.009324039579265775)]

    private SelectStatement authorizeRoleStatement;
// authorizeRoleStatement No	: [('select', 0.32902294995285314), ('authenticateStatement', 0.302233679338283), ('authorizeUserStatement', 0.0522336140845425), ('loadRoleStatement', 0.0522336140845425), ('statement', 0.020098228494969735), ('selectStatement', 0.0044658874491663066), ('key', 5.781783229972853e-05), ('put', 5.347845855814692e-05), ('result', 4.3625143746435284e-05), ('index', 4.046033733340207e-05)]

    public CassandraAuthorizer()
    {
    }

    // Returns every permission on the resource granted to the user either directly
    // or indirectly via roles granted to the user.
    public Set<Permission> authorize(AuthenticatedUser user, IResource resource)
// user                 0	: [('user', 0.891742002048933), ('performer', 0.04674419579332245), ('u', 0.0004613866828224485), ('SYSTEM_USER', 0.00045999188411979726), ('ANONYMOUS_USER', 0.0004599511005320004), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06)]
// resource             0	: [('resource', 0.94328816341862), ('droppedResource', 0.0017364789179610217), ('r', 0.0011630607672357858), ('fromName', 0.0005791857045994454), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06)]
    {
        try
        {
            if (user.isSuper())
// user                 No	: [('c', 0.05257911042062014), ('parsed', 0.05208138992050939), ('replica', 0.03920798561774131), ('logger', 0.03233129924400633), ('bytes', 0.0276379694018121), ('in', 0.026267225458815054), ('conf', 0.0137720910655335), ('update', 0.013215562436265883), ('query', 0.013022152805356341), ('stream', 0.01297999644612818)]
// isSuper              0	: [('isSuper', 0.02083591522904293), ('length', 0.010686877072411081), ('value', 0.010499525084400201), ('getPermissions', 0.010420577844505476), ('canLogin', 0.010419132362005161), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929)]
                return resource.applicablePermissions();
// resource             No	: [('endOfData', 0.10506990382640777), ('o1', 0.036099280852318304), ('original', 0.021049318968189994), ('result', 0.01474010638153541), ('accumulate', 0.012264024185531488), ('empty', 0.01203305835692044), ('current', 0.0112572146772928), ('list', 0.009113795800197493), ('mostInteresting', 0.009023119288074224), ('input', 0.006210477459068103)]

            Set<Permission> permissions = EnumSet.noneOf(Permission.class);
// permissions          1	: [('perms', 0.541125484169235), ('permissions', 0.20564469790297263), ('getPermissions', 0.027420207847071658), ('ALL', 0.01371096075615943), ('NONE', 0.013710534405508023), ('AGGREGATE_FUNCTION_PERMISSIONS', 0.013708699144057167), ('KEYSPACE_LEVEL_PERMISSIONS', 0.013708699144057167), ('TABLE_LEVEL_PERMISSIONS', 0.013708690987339607), ('SCALAR_FUNCTION_PERMISSIONS', 0.013708690987339607), ('entry', 0.0003775781408194497)]

            // Even though we only care about the RoleResource here, we use getRoleDetails as
            // it saves a Set creation in RolesCache
            for (Role role: user.getRoleDetails())
// role                 1	: [('r', 0.6477498861665862), ('role', 0.09470144259643119), ('NO_ROLE', 0.005683322036088062), ('key', 5.781783229972853e-05), ('put', 5.347845855814692e-05), ('result', 4.3625143746435284e-05), ('index', 4.046033733340207e-05), ('id', 2.767060420031942e-05), ('right', 2.2352424351614132e-05), ('cell', 1.8861349236206365e-05)]
// user                 No	: [('sortedRoles', 0.3334116110299587), ('ALL_ROLES', 0.16674500961703256), ('cfs', 0.003549229579012865), ('sstables', 0.0035143022120954306), ('values', 0.0018308744368121241), ('row', 0.0015956845496901402), ('metadata', 0.0015427965945873836), ('ranges', 0.0014778362943924498), ('keyspace', 0.0014301362132096078), ('columns', 0.0013190090931808336)]
                addPermissionsForRole(permissions, resource, role.resource);
// permissions          No	: [('execute', 0.010151481583652106), ('i', 0.006083639409202988), ('cfs', 0.005068962256965817), ('value', 0.002634907092749754), ('name', 0.0025632920004494547), ('e', 0.002522868279954984), ('metadata', 0.0024306739168789638), ('sstable', 0.0022607307776156445), ('keyspace', 0.00221935986422514), ('key', 0.00219491397021435)]
// resource             0	: [('resource', 0.5694885613716163), ('row', 0.00833264639535867), ('i', 0.001197202889546375), ('version', 0.0009433901922713435), ('map', 0.0008960728007554306), ('cfs', 0.0008204649084767461), ('list', 0.0007396358963255117), ('set', 0.0007251697822635238), ('e', 0.0006402024270230983), ('bytes', 0.0006362666743236839)]
// role                 1	: [('grantee', 0.8142643960382987), ('role', 0.025715050155693493), ('permission', 0.025705207466149616), ('user', 0.01285520866928998), ('perm', 0.01285481714684713), ('state', 0.004502895549651229), ('row', 0.0020831615988396676), ('i', 0.00029930072238659375), ('version', 0.00023584754806783587), ('map', 0.00022401820018885766)]
// resource             No	: [('memberOf', 0.21667074751801937), ('equals', 0.08434198048848393), ('cassandra', 0.011654820533747279), ('get', 0.0034708971123600454), ('instance', 0.003133656633786657), ('size', 0.002483063662000674), ('db', 0.0024155168236639716), ('add', 0.0023381697983567607), ('format', 0.0016039769020990786), ('utils', 0.0012407354362760491)]
            return permissions;
// permissions          No	: [('builder', 0.029723607480674187), ('result', 0.027367329391546524), ('sb', 0.017972547518243738), ('size', 0.01760397219283842), ('ret', 0.015024772778709335), ('row', 0.008806320448958353), ('state', 0.005239594476144177), ('accumulate', 0.005224958232722501), ('map', 0.005162650741676716), ('r', 0.005149793407175974)]
        }
        catch (RequestExecutionException | RequestValidationException e)
// e                    0	: [('e', 0.9418963410115759), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06), ('cell', 4.715337309051591e-06), ('E', 3.6304938736561874e-06), ('limit', 3.4755162400282727e-06)]
        {
            logger.debug("Failed to authorize {} for {}", user, resource);
// logger               0	: [('logger', 0.063604188189724), ('e', 0.005844760900606333), ('fail', 0.004201397438717271), ('errorMsg', 0.003020900702353581), ('sstable', 0.0022158743934160164), ('options', 0.001539945892881878), ('readMetrics', 0.0012928728307175063), ('onException', 0.0012901531134101145), ('writeMetrics', 0.0010786036593282275), ('key', 2.6656751893401148e-05)]
// debug                4	: [('error', 0.32690716285887345), ('warn', 0.2502438422643318), ('info', 0.14710638121917), ('trace', 0.10987713358122408), ('debug', 0.10355151237571622), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929)]
// user                 No	: [('endpoint', 0.06408777779046271), ('session', 0.05181494652983684), ('active', 0.032993672131383406), ('cfs', 0.02808137751369681), ('sessionID', 0.02202205968580592), ('e', 0.02048297509311096), ('keyspaceName', 0.019178441658032497), ('ksName', 0.018718667367333176), ('file', 0.012536753988466173), ('role', 0.012196357101797154)]
// resource             3	: [('password', 0.371828085142111), ('timestamp', 0.18611462545198365), ('passwd', 0.03846550158564921), ('resource', 0.019274886157941172), ('pth', 0.019247638428470226), ('row', 0.00833264639535867), ('i', 0.001197202889546375), ('version', 0.0009433901922713435), ('map', 0.0008960728007554306), ('cfs', 0.0008204649084767461)]
            throw new UnauthorizedException("Unable to perform authorization of permissions: " + e.getMessage(), e);
// e                    0	: [('e', 0.754454603742187), ('KEYSPACE', 0.022367533463255245), ('i', 0.014932966713592769), ('type', 0.005896915677612151), ('keyspace', 0.0049547892089680185), ('myType', 0.00330206312477987), ('conf', 0.002779988215622103), ('name', 0.00261447024597139), ('fIntMax', 0.0023172173770406737), ('key', 0.0010619178168364929)]
// e                    0	: [('e', 0.45981857380542646), ('options', 0.16615433634251942), ('deserializedEx', 0.03664597040762452), ('ex', 0.01833908680531354), ('exception', 0.018327855600169782), ('sw', 0.018321993764249495), ('acquireSleepMillis', 0.01832189588363878), ('targetException', 0.018320973657448458), ('cfs', 0.0027374147761781444), ('key', 0.002687627734123631)]
        }
    }

    public void grant(AuthenticatedUser performer, Set<Permission> permissions, IResource resource, RoleResource grantee)
// performer            0	: [('performer', 0.8384108624599891), ('user', 0.016742002048932936), ('u', 0.0004613866828224485), ('SYSTEM_USER', 0.00045999188411979726), ('ANONYMOUS_USER', 0.0004599511005320004), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06)]
// permissions          0	: [('permissions', 0.7056446979029727), ('perms', 0.04112548416923507), ('getPermissions', 0.027420207847071658), ('ALL', 0.01371096075615943), ('NONE', 0.013710534405508023), ('AGGREGATE_FUNCTION_PERMISSIONS', 0.013708699144057167), ('KEYSPACE_LEVEL_PERMISSIONS', 0.013708699144057167), ('TABLE_LEVEL_PERMISSIONS', 0.013708690987339607), ('SCALAR_FUNCTION_PERMISSIONS', 0.013708690987339607), ('entry', 0.0003775781408194497)]
// resource             0	: [('resource', 0.94328816341862), ('droppedResource', 0.0017364789179610217), ('r', 0.0011630607672357858), ('fromName', 0.0005791857045994454), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06)]
// grantee              0	: [('grantee', 0.3985371218101741), ('revokee', 0.20045877178928545), ('from', 0.09752944517668179), ('of', 0.09752883342286485), ('to', 0.09752752834805535), ('role', 0.045581201699496914), ('primaryRole', 0.002360368488383909), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05)]
    throws RequestValidationException, RequestExecutionException
    {
        modifyRolePermissions(permissions, resource, grantee, "+");
// permissions          No	: [('execute', 0.010151481583652106), ('i', 0.006083639409202988), ('cfs', 0.005068962256965817), ('value', 0.002634907092749754), ('name', 0.0025632920004494547), ('e', 0.002522868279954984), ('metadata', 0.0024306739168789638), ('sstable', 0.0022607307776156445), ('keyspace', 0.00221935986422514), ('key', 0.00219491397021435)]
// resource             0	: [('resource', 0.5694885613716163), ('row', 0.00833264639535867), ('i', 0.001197202889546375), ('version', 0.0009433901922713435), ('map', 0.0008960728007554306), ('cfs', 0.0008204649084767461), ('list', 0.0007396358963255117), ('set', 0.0007251697822635238), ('e', 0.0006402024270230983), ('bytes', 0.0006362666743236839)]
// grantee              0	: [('grantee', 0.8142643960382987), ('role', 0.025715050155693493), ('permission', 0.025705207466149616), ('user', 0.01285520866928998), ('perm', 0.01285481714684713), ('state', 0.004502895549651229), ('row', 0.0020831615988396676), ('i', 0.00029930072238659375), ('version', 0.00023584754806783587), ('map', 0.00022401820018885766)]
        addLookupEntry(resource, grantee);
// resource             No	: [('execute', 0.010151481583652106), ('i', 0.006083639409202988), ('cfs', 0.005068962256965817), ('value', 0.002634907092749754), ('name', 0.0025632920004494547), ('e', 0.002522868279954984), ('metadata', 0.0024306739168789638), ('sstable', 0.0022607307776156445), ('keyspace', 0.00221935986422514), ('key', 0.00219491397021435)]
// grantee              5	: [('state', 0.2055115821986049), ('r', 0.0685655347364721), ('callback', 0.06848096940177059), ('pd', 0.06846695401459227), ('isSuper', 0.06845663771832385), ('grantee', 0.02978485688046744), ('role', 0.011951109713683048), ('permission', 0.011911738955507551), ('row', 0.00833264639535867), ('user', 0.005966289222614463)]
    }

    public void revoke(AuthenticatedUser performer, Set<Permission> permissions, IResource resource, RoleResource revokee)
// performer            0	: [('performer', 0.8904941957933225), ('user', 0.016742002048932936), ('u', 0.0004613866828224485), ('SYSTEM_USER', 0.00045999188411979726), ('ANONYMOUS_USER', 0.0004599511005320004), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06)]
// permissions          0	: [('permissions', 0.7056446979029727), ('perms', 0.04112548416923507), ('getPermissions', 0.027420207847071658), ('ALL', 0.01371096075615943), ('NONE', 0.013710534405508023), ('AGGREGATE_FUNCTION_PERMISSIONS', 0.013708699144057167), ('KEYSPACE_LEVEL_PERMISSIONS', 0.013708699144057167), ('TABLE_LEVEL_PERMISSIONS', 0.013708690987339607), ('SCALAR_FUNCTION_PERMISSIONS', 0.013708690987339607), ('entry', 0.0003775781408194497)]
// resource             0	: [('resource', 0.94328816341862), ('droppedResource', 0.0017364789179610217), ('r', 0.0011630607672357858), ('fromName', 0.0005791857045994454), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06)]
// revokee              1	: [('grantee', 0.3985371218101741), ('revokee', 0.20045877178928545), ('from', 0.09752944517668179), ('of', 0.09752883342286485), ('to', 0.09752752834805535), ('role', 0.045581201699496914), ('primaryRole', 0.002360368488383909), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05)]
    throws RequestValidationException, RequestExecutionException
    {
        modifyRolePermissions(permissions, resource, revokee, "-");
// permissions          No	: [('execute', 0.010151481583652106), ('i', 0.006083639409202988), ('cfs', 0.005068962256965817), ('value', 0.002634907092749754), ('name', 0.0025632920004494547), ('e', 0.002522868279954984), ('metadata', 0.0024306739168789638), ('sstable', 0.0022607307776156445), ('keyspace', 0.00221935986422514), ('key', 0.00219491397021435)]
// resource             0	: [('resource', 0.5694885613716163), ('row', 0.00833264639535867), ('i', 0.001197202889546375), ('version', 0.0009433901922713435), ('map', 0.0008960728007554306), ('cfs', 0.0008204649084767461), ('list', 0.0007396358963255117), ('set', 0.0007251697822635238), ('e', 0.0006402024270230983), ('bytes', 0.0006362666743236839)]
// revokee              No	: [('grantee', 0.8142643960382987), ('role', 0.025715050155693493), ('permission', 0.025705207466149616), ('user', 0.01285520866928998), ('perm', 0.01285481714684713), ('state', 0.004502895549651229), ('row', 0.0020831615988396676), ('i', 0.00029930072238659375), ('version', 0.00023584754806783587), ('map', 0.00022401820018885766)]
        removeLookupEntry(resource, revokee);
// resource             No	: [('execute', 0.010151481583652106), ('i', 0.006083639409202988), ('cfs', 0.005068962256965817), ('value', 0.002634907092749754), ('name', 0.0025632920004494547), ('e', 0.002522868279954984), ('metadata', 0.0024306739168789638), ('sstable', 0.0022607307776156445), ('keyspace', 0.00221935986422514), ('key', 0.00219491397021435)]
// revokee              No	: [('state', 0.2055115821986049), ('r', 0.0685655347364721), ('callback', 0.06848096940177059), ('pd', 0.06846695401459227), ('isSuper', 0.06845663771832385), ('grantee', 0.02978485688046744), ('role', 0.011951109713683048), ('permission', 0.011911738955507551), ('row', 0.00833264639535867), ('user', 0.005966289222614463)]
    }

    // Called when deleting a role with DROP ROLE query.
    // Internal hook, so no permission checks are needed here.
    // Executes a logged batch removing the granted premissions
    // for the role as well as the entries from the reverse index
    // table
    public void revokeAllFrom(RoleResource revokee)
// revokee              0	: [('revokee', 0.5036211342952635), ('droppedRole', 0.376392962145676), ('role', 0.04177919309117553), ('grantee', 0.010361607702091848), ('primaryRole', 0.005737939028795195), ('subject', 0.005571063274139176), ('resource', 0.0017279534760570848), ('o', 0.0013958659371271567), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05)]
    {
        try
        {
            UntypedResultSet rows = process(String.format("SELECT resource FROM %s.%s WHERE role = '%s'",
// rows                 2	: [('result', 0.21672096259594567), ('rs', 0.1100700005673203), ('rows', 0.051334753595839444), ('results', 0.0317178817342926), ('res', 0.024788004717010252), ('queryResultSet', 0.01872513721505633), ('key', 0.00011563566459945706), ('put', 0.00010695691711629383), ('index', 8.092067466680414e-05)]
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                                                          SchemaConstants.AUTH_KEYSPACE_NAME,
// AUTH_KEYSPACE_NAME   1	: [('SCHEMA_KEYSPACE_NAME', 0.5282260224615933), ('AUTH_KEYSPACE_NAME', 0.22450385971739895), ('SYSTEM_KEYSPACE_NAME', 0.12527320597790487), ('NAME_LENGTH', 0.030713540773412356), ('DISTRIBUTED_KEYSPACE_NAME', 0.015931977626946186), ('TRACE_KEYSPACE_NAME', 0.002957130517002094), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                          AuthKeyspace.ROLE_PERMISSIONS,
// ROLE_PERMISSIONS     No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                          escape(revokee.getRoleName())));
// revokee              2	: [('role', 0.4538411305359362), ('grantee', 0.10086089875090867), ('revokee', 0.05042463630720439), ('comparator', 0.014822431393481068), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]

            List<CQLStatement> statements = new ArrayList<>();
// statements           No	: [('entry', 0.006041250253111195), ('sstables', 0.005960681537780471), ('range', 0.005781474010093247), ('type', 0.004518954695705374), ('ranges', 0.00439706070849824), ('tokens', 0.003933481466719807), ('options', 0.003906385597165382), ('message', 0.0035910483886759377), ('comparator', 0.0034078655719055246), ('values', 0.0033781699309036613)]
            for (UntypedResultSet.Row row : rows)
// row                  0	: [('row', 0.7651952422571149), ('r', 0.10587884995450994), ('actual', 0.021035942052908412), ('r1', 0.00473139223072311), ('r2', 0.004731245409807041), ('staticRow', 0.002248022562288473), ('row1', 0.0016050310203803697), ('row2', 0.001605014706945251), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05)]
// rows                 1	: [('execute', 0.1687212820323892), ('rows', 0.15054909900908625), ('query', 0.14759465066152314), ('rs', 0.1283219725746969), ('resultSet', 0.1054265052437173), ('results', 0.04500474544883309), ('batches', 0.02108930495929178), ('columnsRows', 0.02108455572308985), ('cfs', 0.0004436536973766082), ('sstables', 0.0004392877765119288)]
            {
                statements.add(
// statements           No	: [('logger', 0.21783947398485698), ('builder', 0.054251234304444874), ('out', 0.000408755394477069), ('conf', 0.0004059550083156865), ('execute', 0.0003073956025244501), ('result', 0.0002753637877692579), ('sb', 0.0002616990107019225), ('fail', 0.00016913937420114195), ('put', 7.886962002968106e-05), ('key', 2.6656751893401148e-05)]
// add                  1	: [('schema', 0.38026231120751125), ('add', 0.048365659985063036), ('get', 0.031213638884914265), ('size', 0.029237971984195518), ('cassandra', 0.023309641067494558), ('isEmpty', 0.011304458455252329), ('length', 0.007016052177994158), ('instance', 0.006267313267573314), ('stream', 0.005785103230347248), ('key', 0.00028470341075971425)]
                    QueryProcessor.getStatement(String.format("DELETE FROM %s.%s WHERE resource = '%s' AND role = '%s'",
// getStatement         3	: [('CQL_VERSION', 0.5055001895828314), ('instance', 0.12177764186545303), ('metrics', 0.019736634432983072), ('getStatement', 0.0031882759525216874), ('cassandra', 0.0029137051334368197), ('preparedStatementsCount', 0.001991863614129449), ('get', 0.0008677242780900114), ('size', 0.0006207659155001685), ('execute', 0.0005086321812650036), ('key', 3.558792634496428e-05)]
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                                                              SchemaConstants.AUTH_KEYSPACE_NAME,
// AUTH_KEYSPACE_NAME   1	: [('SCHEMA_KEYSPACE_NAME', 0.5282260224615933), ('AUTH_KEYSPACE_NAME', 0.22450385971739895), ('SYSTEM_KEYSPACE_NAME', 0.12527320597790487), ('NAME_LENGTH', 0.030713540773412356), ('DISTRIBUTED_KEYSPACE_NAME', 0.015931977626946186), ('TRACE_KEYSPACE_NAME', 0.002957130517002094), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                              AuthKeyspace.RESOURCE_ROLE_INDEX,
// RESOURCE_ROLE_INDEX  No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                              escape(row.getString("resource")),
// row                  No	: [('role', 0.4538411305359362), ('grantee', 0.10086089875090867), ('revokee', 0.05042463630720439), ('comparator', 0.014822431393481068), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]
                                                              escape(revokee.getRoleName())),
// revokee              1	: [('grantee', 0.4418818913543938), ('revokee', 0.34593949241013444), ('role', 0.11346028263398406), ('comparator', 0.003705607848370267), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868), ('cfs', 0.0003168101410603636), ('value', 0.00016468169329685964), ('name', 0.00016020575002809092), ('e', 0.0001576792674971865)]
                                                ClientState.forInternalCalls()));

            }

            statements.add(QueryProcessor.getStatement(String.format("DELETE FROM %s.%s WHERE role = '%s'",
// statements           No	: [('sb', 0.08412358019912373), ('idx', 0.04324677926817577), ('logger', 0.03587399032096134), ('json', 0.03406838811255619), ('builder', 0.032897557828164524), ('expectedEndpoints', 0.021623014802360025), ('groups', 0.02162243567541331), ('options', 0.011292884253351803), ('query', 0.010893940275307068), ('rows', 0.010822690740576086)]
// add                  1	: [('schema', 0.38026231120751125), ('add', 0.048365659985063036), ('get', 0.031213638884914265), ('size', 0.029237971984195518), ('cassandra', 0.023309641067494558), ('isEmpty', 0.011304458455252329), ('length', 0.007016052177994158), ('instance', 0.006267313267573314), ('stream', 0.005785103230347248), ('key', 0.00028470341075971425)]
// getStatement         3	: [('CQL_VERSION', 0.5055001895828314), ('instance', 0.12177764186545303), ('metrics', 0.019736634432983072), ('getStatement', 0.0031882759525216874), ('cassandra', 0.0029137051334368197), ('preparedStatementsCount', 0.001991863614129449), ('get', 0.0008677242780900114), ('size', 0.0006207659155001685), ('execute', 0.0005086321812650036), ('key', 3.558792634496428e-05)]
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                                                                     SchemaConstants.AUTH_KEYSPACE_NAME,
// AUTH_KEYSPACE_NAME   1	: [('SCHEMA_KEYSPACE_NAME', 0.5282260224615933), ('AUTH_KEYSPACE_NAME', 0.22450385971739895), ('SYSTEM_KEYSPACE_NAME', 0.12527320597790487), ('NAME_LENGTH', 0.030713540773412356), ('DISTRIBUTED_KEYSPACE_NAME', 0.015931977626946186), ('TRACE_KEYSPACE_NAME', 0.002957130517002094), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                                     AuthKeyspace.ROLE_PERMISSIONS,
// ROLE_PERMISSIONS     No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                                     escape(revokee.getRoleName())),
// revokee              2	: [('role', 0.4538411305359362), ('grantee', 0.10086089875090867), ('revokee', 0.05042463630720439), ('comparator', 0.014822431393481068), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]
                                                       ClientState.forInternalCalls()));

            executeLoggedBatch(statements);
// statements           No	: [('execute', 0.010151481583652106), ('i', 0.006083639409202988), ('cfs', 0.005068962256965817), ('value', 0.002634907092749754), ('name', 0.0025632920004494547), ('e', 0.002522868279954984), ('metadata', 0.0024306739168789638), ('sstable', 0.0022607307776156445), ('keyspace', 0.00221935986422514), ('key', 0.00219491397021435)]
        }
        catch (RequestExecutionException | RequestValidationException e)
// e                    0	: [('e', 0.9418963410115759), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06), ('cell', 4.715337309051591e-06), ('E', 3.6304938736561874e-06), ('limit', 3.4755162400282727e-06)]
        {
            logger.warn(String.format("CassandraAuthorizer failed to revoke all permissions of %s", revokee.getRoleName()), e);
// logger               0	: [('logger', 0.063604188189724), ('e', 0.005844760900606333), ('fail', 0.004201397438717271), ('errorMsg', 0.003020900702353581), ('sstable', 0.0022158743934160164), ('options', 0.001539945892881878), ('readMetrics', 0.0012928728307175063), ('onException', 0.0012901531134101145), ('writeMetrics', 0.0010786036593282275), ('key', 2.6656751893401148e-05)]
// warn                 1	: [('error', 0.32690716285887345), ('warn', 0.2502438422643318), ('info', 0.14710638121917), ('trace', 0.10987713358122408), ('debug', 0.10355151237571622), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929)]
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// revokee              No	: [('KEYSPACE', 0.05641381716025334), ('value', 0.030316618057123223), ('KS_NAME', 0.02780633123648549), ('keyspace', 0.027742039009843827), ('name', 0.022782836862456673), ('i', 0.020417836937359362), ('source', 0.015616079701010572), ('parsed', 0.015423131379266663), ('indexName', 0.014930051756699949), ('legacyVersion', 0.013551934812488457)]
// e                    4	: [('method', 0.25277266762464395), ('options', 0.16977000972745093), ('row', 0.09998086034645041), ('includeInherited', 0.08425642116801359), ('e', 0.0145109125746246), ('cfs', 0.006309103449942347), ('t', 0.005833948157150274), ('message', 0.005807075225272512), ('protocolVersion', 0.004788231429474055), ('operation', 0.0037033029517885506)]
        }
    }

    // Called after a resource is removed (DROP KEYSPACE, DROP TABLE, etc.).
    // Execute a logged batch removing all the permissions for the resource
    // as well as the index table entry
    public void revokeAllOn(IResource droppedResource)
// droppedResource      0	: [('droppedResource', 0.8954864789179611), ('resource', 0.04861223749269404), ('r', 0.013663060767235786), ('fromName', 0.0005791857045994454), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06)]
    {
        try
        {
            UntypedResultSet rows = process(String.format("SELECT role FROM %s.%s WHERE resource = '%s'",
// rows                 2	: [('result', 0.21672096259594567), ('rs', 0.1100700005673203), ('rows', 0.051334753595839444), ('results', 0.0317178817342926), ('res', 0.024788004717010252), ('queryResultSet', 0.01872513721505633), ('key', 0.00011563566459945706), ('put', 0.00010695691711629383), ('index', 8.092067466680414e-05)]
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                                                          SchemaConstants.AUTH_KEYSPACE_NAME,
// AUTH_KEYSPACE_NAME   1	: [('SCHEMA_KEYSPACE_NAME', 0.5282260224615933), ('AUTH_KEYSPACE_NAME', 0.22450385971739895), ('SYSTEM_KEYSPACE_NAME', 0.12527320597790487), ('NAME_LENGTH', 0.030713540773412356), ('DISTRIBUTED_KEYSPACE_NAME', 0.015931977626946186), ('TRACE_KEYSPACE_NAME', 0.002957130517002094), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                          AuthKeyspace.RESOURCE_ROLE_INDEX,
// RESOURCE_ROLE_INDEX  No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                          escape(droppedResource.getName())));
// droppedResource      No	: [('role', 0.4538411305359362), ('grantee', 0.10086089875090867), ('revokee', 0.05042463630720439), ('comparator', 0.014822431393481068), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]

            List<CQLStatement> statements = new ArrayList<>();
// statements           No	: [('entry', 0.006041250253111195), ('sstables', 0.005960681537780471), ('range', 0.005781474010093247), ('type', 0.004518954695705374), ('ranges', 0.00439706070849824), ('tokens', 0.003933481466719807), ('options', 0.003906385597165382), ('message', 0.0035910483886759377), ('comparator', 0.0034078655719055246), ('values', 0.0033781699309036613)]
            for (UntypedResultSet.Row row : rows)
// row                  0	: [('row', 0.7651952422571149), ('r', 0.10587884995450994), ('actual', 0.021035942052908412), ('r1', 0.00473139223072311), ('r2', 0.004731245409807041), ('staticRow', 0.002248022562288473), ('row1', 0.0016050310203803697), ('row2', 0.001605014706945251), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05)]
// rows                 1	: [('execute', 0.1687212820323892), ('rows', 0.15054909900908625), ('query', 0.14759465066152314), ('rs', 0.1283219725746969), ('resultSet', 0.1054265052437173), ('results', 0.04500474544883309), ('batches', 0.02108930495929178), ('columnsRows', 0.02108455572308985), ('cfs', 0.0004436536973766082), ('sstables', 0.0004392877765119288)]
            {
                statements.add(QueryProcessor.getStatement(String.format("DELETE FROM %s.%s WHERE role = '%s' AND resource = '%s'",
// statements           No	: [('logger', 0.21783947398485698), ('builder', 0.054251234304444874), ('out', 0.000408755394477069), ('conf', 0.0004059550083156865), ('execute', 0.0003073956025244501), ('result', 0.0002753637877692579), ('sb', 0.0002616990107019225), ('fail', 0.00016913937420114195), ('put', 7.886962002968106e-05), ('key', 2.6656751893401148e-05)]
// add                  1	: [('schema', 0.38026231120751125), ('add', 0.048365659985063036), ('get', 0.031213638884914265), ('size', 0.029237971984195518), ('cassandra', 0.023309641067494558), ('isEmpty', 0.011304458455252329), ('length', 0.007016052177994158), ('instance', 0.006267313267573314), ('stream', 0.005785103230347248), ('key', 0.00028470341075971425)]
// getStatement         3	: [('CQL_VERSION', 0.5055001895828314), ('instance', 0.12177764186545303), ('metrics', 0.019736634432983072), ('getStatement', 0.0031882759525216874), ('cassandra', 0.0029137051334368197), ('preparedStatementsCount', 0.001991863614129449), ('get', 0.0008677242780900114), ('size', 0.0006207659155001685), ('execute', 0.0005086321812650036), ('key', 3.558792634496428e-05)]
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                                                                         SchemaConstants.AUTH_KEYSPACE_NAME,
// AUTH_KEYSPACE_NAME   1	: [('SCHEMA_KEYSPACE_NAME', 0.5282260224615933), ('AUTH_KEYSPACE_NAME', 0.22450385971739895), ('SYSTEM_KEYSPACE_NAME', 0.12527320597790487), ('NAME_LENGTH', 0.030713540773412356), ('DISTRIBUTED_KEYSPACE_NAME', 0.015931977626946186), ('TRACE_KEYSPACE_NAME', 0.002957130517002094), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                                         AuthKeyspace.ROLE_PERMISSIONS,
// ROLE_PERMISSIONS     No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                                         escape(row.getString("role")),
// row                  No	: [('role', 0.4538411305359362), ('grantee', 0.10086089875090867), ('revokee', 0.05042463630720439), ('comparator', 0.014822431393481068), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]
                                                                         escape(droppedResource.getName())),
// droppedResource      No	: [('grantee', 0.4418818913543938), ('revokee', 0.34593949241013444), ('role', 0.11346028263398406), ('comparator', 0.003705607848370267), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868), ('cfs', 0.0003168101410603636), ('value', 0.00016468169329685964), ('name', 0.00016020575002809092), ('e', 0.0001576792674971865)]
                                                           ClientState.forInternalCalls()));
            }

            statements.add(QueryProcessor.getStatement(String.format("DELETE FROM %s.%s WHERE resource = '%s'",
// statements           No	: [('sb', 0.08412358019912373), ('idx', 0.04324677926817577), ('logger', 0.03587399032096134), ('json', 0.03406838811255619), ('builder', 0.032897557828164524), ('expectedEndpoints', 0.021623014802360025), ('groups', 0.02162243567541331), ('options', 0.011292884253351803), ('query', 0.010893940275307068), ('rows', 0.010822690740576086)]
// add                  1	: [('schema', 0.38026231120751125), ('add', 0.048365659985063036), ('get', 0.031213638884914265), ('size', 0.029237971984195518), ('cassandra', 0.023309641067494558), ('isEmpty', 0.011304458455252329), ('length', 0.007016052177994158), ('instance', 0.006267313267573314), ('stream', 0.005785103230347248), ('key', 0.00028470341075971425)]
// getStatement         3	: [('CQL_VERSION', 0.5055001895828314), ('instance', 0.12177764186545303), ('metrics', 0.019736634432983072), ('getStatement', 0.0031882759525216874), ('cassandra', 0.0029137051334368197), ('preparedStatementsCount', 0.001991863614129449), ('get', 0.0008677242780900114), ('size', 0.0006207659155001685), ('execute', 0.0005086321812650036), ('key', 3.558792634496428e-05)]
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                                                                     SchemaConstants.AUTH_KEYSPACE_NAME,
// AUTH_KEYSPACE_NAME   1	: [('SCHEMA_KEYSPACE_NAME', 0.5282260224615933), ('AUTH_KEYSPACE_NAME', 0.22450385971739895), ('SYSTEM_KEYSPACE_NAME', 0.12527320597790487), ('NAME_LENGTH', 0.030713540773412356), ('DISTRIBUTED_KEYSPACE_NAME', 0.015931977626946186), ('TRACE_KEYSPACE_NAME', 0.002957130517002094), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                                     AuthKeyspace.RESOURCE_ROLE_INDEX,
// RESOURCE_ROLE_INDEX  No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                                                     escape(droppedResource.getName())),
// droppedResource      No	: [('role', 0.4538411305359362), ('grantee', 0.10086089875090867), ('revokee', 0.05042463630720439), ('comparator', 0.014822431393481068), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]
                                                      ClientState.forInternalCalls()));

            executeLoggedBatch(statements);
// statements           No	: [('execute', 0.010151481583652106), ('i', 0.006083639409202988), ('cfs', 0.005068962256965817), ('value', 0.002634907092749754), ('name', 0.0025632920004494547), ('e', 0.002522868279954984), ('metadata', 0.0024306739168789638), ('sstable', 0.0022607307776156445), ('keyspace', 0.00221935986422514), ('key', 0.00219491397021435)]
        }
        catch (RequestExecutionException | RequestValidationException e)
// e                    0	: [('e', 0.9418963410115759), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06), ('cell', 4.715337309051591e-06), ('E', 3.6304938736561874e-06), ('limit', 3.4755162400282727e-06)]
        {
            logger.warn(String.format("CassandraAuthorizer failed to revoke all permissions on %s", droppedResource), e);
// logger               0	: [('logger', 0.063604188189724), ('e', 0.005844760900606333), ('fail', 0.004201397438717271), ('errorMsg', 0.003020900702353581), ('sstable', 0.0022158743934160164), ('options', 0.001539945892881878), ('readMetrics', 0.0012928728307175063), ('onException', 0.0012901531134101145), ('writeMetrics', 0.0010786036593282275), ('key', 2.6656751893401148e-05)]
// warn                 1	: [('error', 0.32690716285887345), ('warn', 0.2502438422643318), ('info', 0.14710638121917), ('trace', 0.10987713358122408), ('debug', 0.10355151237571622), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929)]
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
// droppedResource      No	: [('KEYSPACE', 0.05641381716025334), ('value', 0.030316618057123223), ('KS_NAME', 0.02780633123648549), ('keyspace', 0.027742039009843827), ('name', 0.022782836862456673), ('i', 0.020417836937359362), ('source', 0.015616079701010572), ('parsed', 0.015423131379266663), ('indexName', 0.014930051756699949), ('legacyVersion', 0.013551934812488457)]
// e                    5	: [('row', 0.19377555895041318), ('bytes', 0.008598262119243059), ('set', 0.008142354773652523), ('map', 0.006557671583766881), ('list', 0.005560387128519211), ('e', 0.0051333833077851065), ('cfs', 0.005062983048892656), ('range', 0.004435892672711418), ('key', 0.004077372695228671), ('metadata', 0.0038058371163101263)]
        }
    }

    private void executeLoggedBatch(List<CQLStatement> statements)
// statements           No	: [('entry', 0.006041250253111195), ('sstables', 0.005960681537780471), ('range', 0.005781474010093247), ('type', 0.004518954695705374), ('ranges', 0.00439706070849824), ('tokens', 0.003933481466719807), ('options', 0.003906385597165382), ('message', 0.0035910483886759377), ('comparator', 0.0034078655719055246), ('values', 0.0033781699309036613)]
    throws RequestExecutionException, RequestValidationException
    {
        BatchStatement batch = new BatchStatement(BatchStatement.Type.LOGGED,
// batch                0	: [('batch', 0.17325397255034644), ('batchStatement', 0.1425473241338459), ('bs', 0.1293907344718133), ('statement', 0.02194771012277155), ('b', 0.008812719448836137), ('batchStmt', 0.004388842113339512), ('key', 0.00011563566459945706), ('put', 0.00010695691711629383), ('result', 8.725028749287057e-05), ('index', 8.092067466680414e-05)]
                                                  VariableSpecifications.empty(),
// empty                0	: [('empty', 0.9375178031893303), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965), ('utils', 0.0003101838590690123), ('put', 0.0002864676024952338)]
                                                  Lists.newArrayList(Iterables.filter(statements, ModificationStatement.class)),
// filter               2	: [('transform', 0.49563979144899406), ('concat', 0.17775570266701105), ('filter', 0.17571339582326456), ('isEmpty', 0.01827025271098557), ('size', 0.013270317261462281), ('get', 0.009466926670911547), ('all', 0.006710300022231528), ('cassandra', 0.0029137051334368197), ('instance', 0.0007834141584466643), ('key', 3.558792634496428e-05)]
// statements           No	: [('sstables', 0.08831726889080027), ('commonRange', 0.08787063639058963), ('ldesired', 0.05215561563930266), ('columns', 0.0452411281536522), ('cur', 0.043946818150943194), ('cache', 0.04393828365694285), ('allNeighbors', 0.04393537007638241), ('subscribersAll', 0.04393533744951217), ('cfs', 0.026211983727195607), ('filter', 0.007055763876101224)]
                                                  Attributes.none());
// none                 0	: [('none', 0.2480525166753668), ('MAX_TTL', 0.17659204300136014), ('cassandra', 0.011654820533747279), ('get', 0.0034708971123600454), ('instance', 0.003133656633786657), ('size', 0.002483063662000674), ('db', 0.0024155168236639716), ('add', 0.0023381697983567607), ('format', 0.0016039769020990786), ('utils', 0.0012407354362760491)]
        processBatch(batch);
// batch                1	: [('statement', 0.13647862513252715), ('batch', 0.09096060640547082), ('execute', 0.005075740791826053), ('i', 0.003041819704601494), ('cfs', 0.0025344811284829087), ('value', 0.001317453546374877), ('name', 0.0012816460002247274), ('e', 0.001261434139977492), ('metadata', 0.0012153369584394819), ('sstable', 0.0011303653888078222)]
    }

    // Add every permission on the resource granted to the role
    private void addPermissionsForRole(Set<Permission> permissions, IResource resource, RoleResource role)
// permissions          0	: [('permissions', 0.7056446979029727), ('perms', 0.04112548416923507), ('getPermissions', 0.027420207847071658), ('ALL', 0.01371096075615943), ('NONE', 0.013710534405508023), ('AGGREGATE_FUNCTION_PERMISSIONS', 0.013708699144057167), ('KEYSPACE_LEVEL_PERMISSIONS', 0.013708699144057167), ('TABLE_LEVEL_PERMISSIONS', 0.013708690987339607), ('SCALAR_FUNCTION_PERMISSIONS', 0.013708690987339607), ('entry', 0.0003775781408194497)]
// resource             0	: [('resource', 0.94328816341862), ('droppedResource', 0.0017364789179610217), ('r', 0.0011630607672357858), ('fromName', 0.0005791857045994454), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06)]
// role                 5	: [('grantee', 0.3985371218101741), ('revokee', 0.20045877178928545), ('from', 0.09752944517668179), ('of', 0.09752883342286485), ('to', 0.09752752834805535), ('role', 0.045581201699496914), ('primaryRole', 0.002360368488383909), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05)]
    throws RequestExecutionException, RequestValidationException
    {
        QueryOptions options = QueryOptions.forInternalCalls(ConsistencyLevel.LOCAL_ONE,
// options              0	: [('options', 0.5042210255866475), ('queryOptions', 0.008785222618464353), ('wrapped', 0.0026844862410613612), ('statementOptions', 0.0007668232633490384), ('largeOptions', 0.000766366487165714), ('b', 0.0004224690135877107), ('a', 0.00041555211709737), ('DEFAULT', 0.0003895811283883553), ('optionsStr', 0.0003846870978527369), ('key', 0.00011563566459945706)]
                                                             Lists.newArrayList(ByteBufferUtil.bytes(role.getRoleName()),
// bytes                0	: [('bytes', 0.8484252481874136), ('EMPTY_BYTE_BUFFER', 0.040345328736326735), ('string', 0.0057430890663277435), ('cassandra', 0.0029137051334368197), ('UNSET_BYTE_BUFFER', 0.0026441787235686096), ('readBytes', 0.0014005703936345497), ('read', 0.0012214438602213217), ('compare', 0.0011305622530486618), ('clone', 0.0010644229346309275), ('inputStream', 0.000311949218433372)]
// role                 No	: [('i', 0.04210071521578805), ('key', 0.023428102451337123), ('columnName', 0.012965249863051578), ('v', 0.011788612649924826), ('name', 0.008474853935526048), ('udtField2', 0.007776664284068712), ('udtField1', 0.007776664284068712), ('colSpec', 0.005186082686152043), ('columnValuePrefix', 0.0051845872095759365), ('path', 0.0026173552748012547)]
                                                                                ByteBufferUtil.bytes(resource.getName())));
// bytes                0	: [('bytes', 0.7933873600451673), ('EMPTY_BYTE_BUFFER', 0.11035640516899244), ('cassandra', 0.0029137051334368197), ('UNSET_BYTE_BUFFER', 0.002105385620120334), ('string', 0.002092374845601695), ('read', 0.0012818626119272627), ('compare', 0.0009820032047364062), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
// resource             No	: [('i', 0.03583577327589734), ('value', 0.024047110983354176), ('data', 0.020264099478858932), ('key', 0.018732064199971005), ('values', 0.010150733551040984), ('j', 0.01013848961277237), ('v', 0.009440593524241767), ('s', 0.008530450008219233), ('udtName', 0.00738179462853833), ('pk', 0.006745912044660536)]

        ResultMessage.Rows rows = select(authorizeRoleStatement, options);
// rows                 0	: [('rows', 0.5941139069046525), ('msg', 0.10718007573050063), ('resp', 0.10717580161049954), ('select', 0.02248529959277539), ('execute', 0.01352877763140726), ('rowMsg', 0.00043745521406552573), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05)]
// select               0	: [('select', 0.17560341073176639), ('statement', 0.08781156609218309), ('authenticateStatement', 0.08779319125254034), ('execute', 0.0012629154079776808), ('rows', 0.0012187283941004386), ('compact', 0.0011770250293624666), ('result', 0.0006355755398723185), ('query', 0.0006337597892239951), ('data', 0.0006200864162628503), ('cfs', 0.0004008812166799422)]
// authorizeRoleStatement No	: [('authorizeUserStatement', 0.385359949891911), ('loadRoleStatement', 0.385359949891911), ('settings', 0.06218376070321274), ('key', 0.020856046592002866), ('params', 0.011934576872425136), ('reader', 0.011142981977131962), ('t', 0.010439636397049687), ('filter', 0.010379877925641325), ('names', 0.002983914480028525), ('execute', 0.0006344675989782566)]
// options              No	: [('row', 0.03333058558143468), ('i', 0.0047888115581855), ('version', 0.0037735607690853735), ('map', 0.003584291203021723), ('cfs', 0.0032818596339069844), ('list', 0.002958543585302047), ('set', 0.0029006791290540953), ('e', 0.002560809708092393), ('bytes', 0.0025450666972947357), ('key', 0.00247667187968421)]

        UntypedResultSet result = UntypedResultSet.create(rows.result);
// result               0	: [('result', 0.777718329236498), ('rs', 0.029528533953127784), ('rows', 0.02789880468461731), ('results', 0.019268844016305447), ('resultSet', 0.01870406401874609), ('res', 0.010499358434128392), ('batches', 0.00194642131284446), ('columnRows', 0.001838265354802509), ('rawResults', 0.0018382490413673901), ('key', 1.4454458074932133e-05)]
// rows                 0	: [('rows', 0.501033461494878), ('statement', 0.15725612878875445), ('select', 0.031501759461350955), ('cqlRows', 0.0314998591786097), ('selectStatement', 0.031498489082509816), ('cfs', 0.023513853109191015), ('metadata', 0.006934856710735647), ('max', 0.0034847118175158763), ('mutation', 0.0032511747607138794), ('comparator', 0.002756464039903484)]
// result               0	: [('result', 0.7598934870782779), ('size', 0.032805147873115406), ('isEmpty', 0.010781224783635432), ('length', 0.009002790598702277), ('hasNext', 0.008082484738625061), ('stream', 0.005565958345382062), ('next', 0.004887255726140279), ('cassandra', 0.0029137051334368197), ('metadata', 0.0013147930226270071), ('partitionKey', 0.001105925094353873)]

        if (!result.isEmpty() && result.one().has(PERMISSIONS))
// result               4	: [('matcher', 0.017318815358405137), ('dir', 0.013940668153631678), ('isEmpty', 0.011570211917102183), ('options', 0.009700817833219445), ('result', 0.008063619537598092), ('type', 0.00728340255170565), ('deletion', 0.0071418675091642556), ('tokens', 0.006415606265204024), ('isStatic', 0.006156368315050138), ('thisType', 0.006147077827367247)]
// isEmpty              0	: [('isEmpty', 0.47922907033705475), ('one', 0.12761857531224946), ('success', 0.09157100444070408), ('future', 0.09019059629049127), ('add', 0.007026428414501471), ('hasNext', 0.006985319901282261), ('size', 0.005280853634798414), ('row', 0.004699379321081083), ('cassandra', 0.0029137051334368197), ('get', 0.0022383383131777306)]
// result               0	: [('result', 0.03603825922936896), ('currentConnection', 0.028708104769051314), ('cell', 0.017073152274867526), ('deletion', 0.014367586174796087), ('isLive', 0.014355072351500447), ('leavingEndpoints', 0.01435424852302695), ('movingEndpoints', 0.014354224052874271), ('staticDeletions', 0.014354175112568916), ('statement', 0.007518490060815473), ('excludeSet', 0.007177373418678905)]
// one                  0	: [('one', 0.7881448911017231), ('size', 0.017780853634798418), ('minTimestamp', 0.012644978747495617), ('minLocalDeletionTime', 0.012642467004153255), ('add', 0.007026428414501471), ('row', 0.004699379321081083), ('isEmpty', 0.0033518773545985867), ('metadata', 0.0029922790296376066), ('cassandra', 0.0029137051334368197), ('get', 0.0022383383131777306)]
// PERMISSIONS          No	: [('SALTED_HASH', 0.7694203103652506), ('indexName', 0.05827734393993621), ('row', 0.019511810827127985), ('expression', 0.01942970527672837), ('columnName', 0.019425134250111633), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868), ('cfs', 0.0003168101410603636), ('value', 0.00016468169329685964), ('e', 0.0001576792674971865)]
        {
            for (String perm : result.one().getSet(PERMISSIONS, UTF8Type.instance))
// perm                 No	: [('name', 0.10418110543147564), ('table', 0.07159408730949236), ('filePath', 0.03759470441540363), ('keyspace', 0.034650615124329806), ('query', 0.0341439992060284), ('ks', 0.032644422165985745), ('m', 0.030993885625517793), ('message', 0.016120859920189017), ('path', 0.016113773300788933), ('k', 0.015345137353835565)]
// result               No	: [('cfs', 0.007098459158025732), ('sstables', 0.007028604424190861), ('values', 0.0036617488736242483), ('row', 0.00319136909938028), ('metadata', 0.0030855931891747676), ('ranges', 0.002955672588784899), ('keyspace', 0.0028602724264192156), ('columns', 0.002638018186361667), ('tokens', 0.0024821274034714214), ('value', 0.0024531879742272756)]
// one                  6	: [('add', 0.2281057136580059), ('length', 0.10930452583350399), ('get', 0.10895335325271094), ('left', 0.05634839425629092), ('entries', 0.050562088347892116), ('size', 0.021123414539193655), ('one', 0.01924623107355932), ('row', 0.01879751728432433), ('isEmpty', 0.013407509418394347), ('cassandra', 0.011654820533747279)]
// PERMISSIONS          No	: [('i', 0.2890209098523008), ('name', 0.13814082300011235), ('s', 0.13769507729964686), ('execute', 0.0025378703959130266), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('e', 0.000630717069988746), ('metadata', 0.0006076684792197409), ('key', 0.0005487284925535875), ('put', 5.40778610737194e-05)]
// instance             0	: [('instance', 0.7531336566337866), ('cassandra', 0.011654820533747279), ('get', 0.0034708971123600454), ('size', 0.002483063662000674), ('db', 0.0024155168236639716), ('add', 0.0023381697983567607), ('format', 0.0016039769020990786), ('utils', 0.0012407354362760491), ('put', 0.0011458704099809353), ('key', 0.00014235170537985712)]
            {
                permissions.add(Permission.valueOf(perm));
// permissions          No	: [('logger', 0.009423040309802623), ('out', 0.0020008647452071098), ('result', 0.0018286412031156387), ('sb', 0.0015819848137463462), ('writer', 0.0012757797186744911), ('builder', 0.0012636993557030305), ('cluster', 0.0010993444231048963), ('verifier', 0.0010624781667918826), ('size', 0.0008709430945272019), ('rewriter', 0.0008237395971921618)]
// add                  5	: [('cassandra', 0.046619282134989115), ('get', 0.013883588449440182), ('instance', 0.012534626535146629), ('size', 0.009932254648002696), ('db', 0.009662067294655886), ('add', 0.009352679193427043), ('format', 0.006415907608396314), ('utils', 0.0049629417451041965), ('put', 0.004583481639923741), ('build', 0.00437491330280743)]
// perm                 No	: [('i', 0.10930703665106274), ('j', 0.03890415852454344), ('r', 0.03685990714832907), ('value', 0.03582233035954397), ('row', 0.017614452167742434), ('options', 0.015504664577307287), ('args', 0.01520016532047784), ('stx', 0.015109910966303985), ('sty', 0.015099121721023685), ('optionValue', 0.012961324395942784)]
            }
        }
    }

    // Adds or removes permissions from a role_permissions table (adds if op is "+", removes if op is "-")
    private void modifyRolePermissions(Set<Permission> permissions, IResource resource, RoleResource role, String op)
// permissions          0	: [('permissions', 0.7056446979029727), ('perms', 0.04112548416923507), ('getPermissions', 0.027420207847071658), ('ALL', 0.01371096075615943), ('NONE', 0.013710534405508023), ('AGGREGATE_FUNCTION_PERMISSIONS', 0.013708699144057167), ('KEYSPACE_LEVEL_PERMISSIONS', 0.013708699144057167), ('TABLE_LEVEL_PERMISSIONS', 0.013708690987339607), ('SCALAR_FUNCTION_PERMISSIONS', 0.013708690987339607), ('entry', 0.0003775781408194497)]
// resource             0	: [('resource', 0.94328816341862), ('droppedResource', 0.0017364789179610217), ('r', 0.0011630607672357858), ('fromName', 0.0005791857045994454), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06)]
// role                 5	: [('grantee', 0.3985371218101741), ('revokee', 0.20045877178928545), ('from', 0.09752944517668179), ('of', 0.09752883342286485), ('to', 0.09752752834805535), ('role', 0.045581201699496914), ('primaryRole', 0.002360368488383909), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05)]
// op                   1	: [('methodName', 0.6252116404865681), ('op', 0.12506612995274127), ('name', 0.006449083051450466), ('keyspace', 0.005833567167999862), ('table', 0.0044895374850885605), ('cfName', 0.004167493966919458), ('keyspaceName', 0.0035765818547335774), ('query', 0.0030423467479564724), ('message', 0.0026908128079865035), ('description', 0.001783194986716386)]
            throws RequestExecutionException
    {
        process(String.format("UPDATE %s.%s SET permissions = permissions %s {%s} WHERE role = '%s' AND resource = '%s'",
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                              SchemaConstants.AUTH_KEYSPACE_NAME,
// AUTH_KEYSPACE_NAME   1	: [('SCHEMA_KEYSPACE_NAME', 0.5282260224615933), ('AUTH_KEYSPACE_NAME', 0.22450385971739895), ('SYSTEM_KEYSPACE_NAME', 0.12527320597790487), ('NAME_LENGTH', 0.030713540773412356), ('DISTRIBUTED_KEYSPACE_NAME', 0.015931977626946186), ('TRACE_KEYSPACE_NAME', 0.002957130517002094), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                              AuthKeyspace.ROLE_PERMISSIONS,
// ROLE_PERMISSIONS     No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                              op,
// op                   No	: [('row', 0.03333058558143468), ('i', 0.0047888115581855), ('version', 0.0037735607690853735), ('map', 0.003584291203021723), ('cfs', 0.0032818596339069844), ('list', 0.002958543585302047), ('set', 0.0029006791290540953), ('e', 0.002560809708092393), ('bytes', 0.0025450666972947357), ('key', 0.00247667187968421)]
                              "'" + StringUtils.join(permissions, "','") + "'",
// join                 0	: [('join', 0.43777432530666077), ('replace', 0.17064190836585083), ('EMPTY', 0.051235556613186704), ('split', 0.021786000134463843), ('isEmpty', 0.014577387854642448), ('cassandra', 0.011654820533747279), ('remove', 0.006223699112953605), ('get', 0.0034708971123600454), ('instance', 0.003133656633786657), ('size', 0.002483063662000674)]
// permissions          No	: [('mutation', 0.2562477401009926), ('pb', 0.25622061154525805), ('replicas', 0.031129758182051985), ('directory', 0.018676598190620047), ('tokenMetadata', 0.018669386949706147), ('cfnames', 0.013661128619231825), ('correct', 0.01244052295553822), ('args', 0.00990660575763803), ('s', 0.006268539041280528), ('path', 0.006245173297153503)]
                              escape(role.getRoleName()),
// role                 0	: [('role', 0.4538411305359362), ('grantee', 0.10086089875090867), ('revokee', 0.05042463630720439), ('comparator', 0.014822431393481068), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]
                              escape(resource.getName())));
// resource             No	: [('grantee', 0.4418818913543938), ('revokee', 0.34593949241013444), ('role', 0.11346028263398406), ('comparator', 0.003705607848370267), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868), ('cfs', 0.0003168101410603636), ('value', 0.00016468169329685964), ('name', 0.00016020575002809092), ('e', 0.0001576792674971865)]
    }

    // Removes an entry from the inverted index table (from resource -> role with defined permissions)
    private void removeLookupEntry(IResource resource, RoleResource role) throws RequestExecutionException
// resource             0	: [('resource', 0.3888978999415523), ('droppedResource', 0.16389183134368818), ('r', 0.10930448613788629), ('fromName', 0.004633485636795563), ('key', 0.00011563566459945706), ('put', 0.00010695691711629383), ('result', 8.725028749287057e-05), ('index', 8.092067466680414e-05), ('id', 5.534120840063884e-05), ('right', 4.4704848703228265e-05)]
// role                 2	: [('grantee', 0.35262979917590376), ('revokee', 0.1786953213563487), ('role', 0.09116240339899383), ('from', 0.08394777924225247), ('of', 0.08394655573461857), ('to', 0.08394394558499957), ('primaryRole', 0.004720736976767818), ('key', 2.8908916149864266e-05), ('put', 2.673922927907346e-05), ('result', 2.1812571873217642e-05)]
    {
        process(String.format("DELETE FROM %s.%s WHERE resource = '%s' and role = '%s'",
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                              SchemaConstants.AUTH_KEYSPACE_NAME,
// AUTH_KEYSPACE_NAME   1	: [('SCHEMA_KEYSPACE_NAME', 0.5282260224615933), ('AUTH_KEYSPACE_NAME', 0.22450385971739895), ('SYSTEM_KEYSPACE_NAME', 0.12527320597790487), ('NAME_LENGTH', 0.030713540773412356), ('DISTRIBUTED_KEYSPACE_NAME', 0.015931977626946186), ('TRACE_KEYSPACE_NAME', 0.002957130517002094), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                              AuthKeyspace.RESOURCE_ROLE_INDEX,
// RESOURCE_ROLE_INDEX  No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                              escape(resource.getName()),
// resource             No	: [('role', 0.4538411305359362), ('grantee', 0.10086089875090867), ('revokee', 0.05042463630720439), ('comparator', 0.014822431393481068), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]
                              escape(role.getRoleName())));
// role                 2	: [('grantee', 0.4418818913543938), ('revokee', 0.34593949241013444), ('role', 0.11346028263398406), ('comparator', 0.003705607848370267), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868), ('cfs', 0.0003168101410603636), ('value', 0.00016468169329685964), ('name', 0.00016020575002809092), ('e', 0.0001576792674971865)]
    }

    // Adds an entry to the inverted index table (from resource -> role with defined permissions)
    private void addLookupEntry(IResource resource, RoleResource role) throws RequestExecutionException
// resource             0	: [('resource', 0.3888978999415523), ('droppedResource', 0.16389183134368818), ('r', 0.10930448613788629), ('fromName', 0.004633485636795563), ('key', 0.00011563566459945706), ('put', 0.00010695691711629383), ('result', 8.725028749287057e-05), ('index', 8.092067466680414e-05), ('id', 5.534120840063884e-05), ('right', 4.4704848703228265e-05)]
// role                 2	: [('grantee', 0.35262979917590376), ('revokee', 0.1786953213563487), ('role', 0.09116240339899383), ('from', 0.08394777924225247), ('of', 0.08394655573461857), ('to', 0.08394394558499957), ('primaryRole', 0.004720736976767818), ('key', 2.8908916149864266e-05), ('put', 2.673922927907346e-05), ('result', 2.1812571873217642e-05)]
    {
        process(String.format("INSERT INTO %s.%s (resource, role) VALUES ('%s','%s')",
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                              SchemaConstants.AUTH_KEYSPACE_NAME,
// AUTH_KEYSPACE_NAME   1	: [('SCHEMA_KEYSPACE_NAME', 0.5282260224615933), ('AUTH_KEYSPACE_NAME', 0.22450385971739895), ('SYSTEM_KEYSPACE_NAME', 0.12527320597790487), ('NAME_LENGTH', 0.030713540773412356), ('DISTRIBUTED_KEYSPACE_NAME', 0.015931977626946186), ('TRACE_KEYSPACE_NAME', 0.002957130517002094), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                              AuthKeyspace.RESOURCE_ROLE_INDEX,
// RESOURCE_ROLE_INDEX  No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                              escape(resource.getName()),
// resource             No	: [('role', 0.4538411305359362), ('grantee', 0.10086089875090867), ('revokee', 0.05042463630720439), ('comparator', 0.014822431393481068), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]
                              escape(role.getRoleName())));
// role                 2	: [('grantee', 0.4418818913543938), ('revokee', 0.34593949241013444), ('role', 0.11346028263398406), ('comparator', 0.003705607848370267), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868), ('cfs', 0.0003168101410603636), ('value', 0.00016468169329685964), ('name', 0.00016020575002809092), ('e', 0.0001576792674971865)]
    }

    // 'of' can be null - in that case everyone's permissions have been requested. Otherwise only single user's.
    // If the user requesting 'LIST PERMISSIONS' is not a superuser OR their username doesn't match 'of', we
    // throw UnauthorizedException. So only a superuser can view everybody's permissions. Regular users are only
    // allowed to see their own permissions.
    public Set<PermissionDetails> list(AuthenticatedUser performer,
// list                 0	: [('list', 0.5763669977769729), ('allPerms', 0.019073799757601057), ('details', 0.015421559899059424), ('entry', 0.0003775781408194497), ('sstables', 0.0003725425961112794), ('range', 0.00036134212563082796), ('type', 0.00028243466848158587), ('ranges', 0.00027481629428114), ('tokens', 0.00024584259166998793), ('options', 0.0002441490998228364)]
// performer            0	: [('performer', 0.8904941957933225), ('user', 0.016742002048932936), ('u', 0.0004613866828224485), ('SYSTEM_USER', 0.00045999188411979726), ('ANONYMOUS_USER', 0.0004599511005320004), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06)]
                                       Set<Permission> permissions,
// permissions          0	: [('permissions', 0.7056446979029727), ('perms', 0.04112548416923507), ('getPermissions', 0.027420207847071658), ('ALL', 0.01371096075615943), ('NONE', 0.013710534405508023), ('AGGREGATE_FUNCTION_PERMISSIONS', 0.013708699144057167), ('KEYSPACE_LEVEL_PERMISSIONS', 0.013708699144057167), ('TABLE_LEVEL_PERMISSIONS', 0.013708690987339607), ('SCALAR_FUNCTION_PERMISSIONS', 0.013708690987339607), ('entry', 0.0003775781408194497)]
                                       IResource resource,
// resource             0	: [('resource', 0.94328816341862), ('droppedResource', 0.0017364789179610217), ('r', 0.0011630607672357858), ('fromName', 0.0005791857045994454), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06)]
                                       RoleResource grantee)
// grantee              0	: [('grantee', 0.3985371218101741), ('revokee', 0.20045877178928545), ('from', 0.09752944517668179), ('of', 0.09752883342286485), ('to', 0.09752752834805535), ('role', 0.045581201699496914), ('primaryRole', 0.002360368488383909), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05)]
    throws RequestValidationException, RequestExecutionException
    {
        if (!(performer.isSuper() || performer.isSystem()) && !performer.getRoles().contains(grantee))
// performer            No	: [('o', 0.3440770358651898), ('other', 0.13040169884551694), ('e', 0.06989601567309203), ('receiver', 0.06480746476426782), ('obj', 0.0356386023771943), ('raw', 0.013914933723313344), ('oo', 0.013910790808143432), ('t', 0.010745312930058972), ('result', 0.009506300136008509), ('function', 0.00927937046103221)]
// isSuper              No	: [('cassandra', 0.023309641067494558), ('get', 0.006941794224720092), ('instance', 0.006267313267573314), ('size', 0.004966127324001348), ('db', 0.004831033647327943), ('add', 0.004676339596713521), ('format', 0.0032079538041981572), ('utils', 0.0024814708725520982), ('put', 0.0022917408199618705), ('build', 0.002187456651403715)]
// performer            No	: [('value', 0.07196527779566199), ('rightState', 0.011526576810040476), ('entry', 0.00938112503268028), ('restrictions', 0.009297083569324896), ('right', 0.008749032193923955), ('e', 0.007832087589496889), ('str', 0.0066606394582327645), ('cfs', 0.006194155258425463), ('column', 0.005970215129868173), ('row', 0.005927740299195309)]
// performer            No	: [('isSignalled', 0.21825054935090418), ('previous', 0.10917012877450478), ('isSurveyMode', 0.10912547081395339), ('isInShadowRound', 0.1091254300303656), ('hasTombstones', 0.10911673498306454), ('sstable', 0.029384732766439495), ('right', 0.027380774776634958), ('cur', 0.025793744353979256), ('def', 0.0039955216710884775), ('sty', 0.0014859282498486332)]
// contains             0	: [('contains', 0.7552544882730755), ('size', 0.013657622926134223), ('get', 0.009978370789375525), ('iterator', 0.006742821210392582), ('next', 0.006657710116894873), ('equals', 0.006223364764799724), ('build', 0.005908500070735352), ('map', 0.005741382924524755), ('stream', 0.0038137515867155206), ('filter', 0.0028649209916646458)]
// grantee              No	: [('hosts', 0.10150586217967407), ('sstable', 0.021763571186036675), ('keyspace', 0.018230305657480447), ('replica', 0.016415130952128074), ('ep', 0.014952114296607933), ('indexName', 0.014533229311239204), ('r', 0.012444997577230438), ('a', 0.0118089786605734), ('hostAddress', 0.010939773152159377), ('errorMessage', 0.010732625378146897)]
            throw new UnauthorizedException(String.format("You are not authorized to view %s's permissions",
// format               0	: [('format', 0.9276108521867126), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('join', 0.0006924644449988115), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                                                          grantee == null ? "everyone" : grantee.getRoleName()));
// grantee              No	: [('KEYSPACE', 0.05641381716025334), ('value', 0.030316618057123223), ('KS_NAME', 0.02780633123648549), ('keyspace', 0.027742039009843827), ('name', 0.022782836862456673), ('i', 0.020417836937359362), ('source', 0.015616079701010572), ('parsed', 0.015423131379266663), ('indexName', 0.014930051756699949), ('legacyVersion', 0.013551934812488457)]
// grantee              No	: [('cfs', 0.007098459158025732), ('sstables', 0.007028604424190861), ('values', 0.0036617488736242483), ('row', 0.00319136909938028), ('metadata', 0.0030855931891747676), ('ranges', 0.002955672588784899), ('keyspace', 0.0028602724264192156), ('columns', 0.002638018186361667), ('tokens', 0.0024821274034714214), ('value', 0.0024531879742272756)]

        if (null == grantee)
// grantee              No	: [('keyspace', 0.1817349691081125), ('table', 0.08307479500971438), ('column', 0.05475550425425737), ('type', 0.04109597212136801), ('next', 0.03232672991878082), ('view', 0.0273910560778247), ('partitionKeyColumns', 0.02737359257845328), ('item', 0.027373543638147927), ('expectedVersion', 0.027372988981353888), ('builder', 0.013703126415060355)]
            return listPermissionsForRole(permissions, resource, grantee);
// permissions          No	: [('execute', 0.010151481583652106), ('i', 0.006083639409202988), ('cfs', 0.005068962256965817), ('value', 0.002634907092749754), ('name', 0.0025632920004494547), ('e', 0.002522868279954984), ('metadata', 0.0024306739168789638), ('sstable', 0.0022607307776156445), ('keyspace', 0.00221935986422514), ('key', 0.00219491397021435)]
// resource             0	: [('resource', 0.5694885613716163), ('row', 0.00833264639535867), ('i', 0.001197202889546375), ('version', 0.0009433901922713435), ('map', 0.0008960728007554306), ('cfs', 0.0008204649084767461), ('list', 0.0007396358963255117), ('set', 0.0007251697822635238), ('e', 0.0006402024270230983), ('bytes', 0.0006362666743236839)]
// grantee              0	: [('grantee', 0.8142643960382987), ('role', 0.025715050155693493), ('permission', 0.025705207466149616), ('user', 0.01285520866928998), ('perm', 0.01285481714684713), ('state', 0.004502895549651229), ('row', 0.0020831615988396676), ('i', 0.00029930072238659375), ('version', 0.00023584754806783587), ('map', 0.00022401820018885766)]

        Set<RoleResource> roles = DatabaseDescriptor.getRoleManager().getRoles(grantee, true);
// roles                1	: [('granted', 0.28334289141002716), ('roles', 0.28333700976803117), ('f', 0.06679628388243704), ('isSuperuser', 0.06667365913137024), ('sortedRoles', 0.06667321866862204), ('builder', 0.03374505469571343), ('sorted', 0.03336084629128252), ('entry', 0.0007551562816388994), ('sstables', 0.0007450851922225588), ('range', 0.0007226842512616559)]
// grantee              0	: [('grantee', 0.4125051406541137), ('currentUser', 0.40625068382154284), ('ROLE_A', 0.03125164817905665), ('role', 0.01876490448272354), ('resource', 0.015631521004223086), ('primaryRole', 0.015626166000299733), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868), ('cfs', 0.0003168101410603636), ('value', 0.00016468169329685964)]
        Set<PermissionDetails> details = new HashSet<>();
// details              2	: [('list', 0.5763669977769729), ('allPerms', 0.019073799757601057), ('details', 0.015421559899059424), ('entry', 0.0003775781408194497), ('sstables', 0.0003725425961112794), ('range', 0.00036134212563082796), ('type', 0.00028243466848158587), ('ranges', 0.00027481629428114), ('tokens', 0.00024584259166998793), ('options', 0.0002441490998228364)]
        for (RoleResource role : roles)
// role                 0	: [('role', 0.6792791930911755), ('r', 0.21389825585537203), ('toGrant', 0.026392978459111146), ('grantee', 0.010361607702091848), ('primaryRole', 0.005737939028795195), ('subject', 0.005571063274139176), ('revokee', 0.003621134295263458), ('resource', 0.0017279534760570848), ('droppedRole', 0.0013929621456760233), ('key', 1.4454458074932133e-05)]
// roles                No	: [('sortedRoles', 0.6250097847120781), ('ALL_ROLES', 0.3125097928687957), ('cfs', 0.0004436536973766082), ('sstables', 0.0004392877765119288), ('values', 0.00022885930460151552), ('row', 0.00019946056871126752), ('metadata', 0.00019284957432342295), ('ranges', 0.00018472953679905623), ('keyspace', 0.00017876702665120097), ('columns', 0.0001648761366476042)]
            details.addAll(listPermissionsForRole(permissions, resource, role));
// details              No	: [('execute', 0.0005161903822804305), ('logger', 0.0004995670488296214), ('builder', 0.00045808196434430487), ('size', 0.00032253357500762047), ('o', 0.0002897661355490962), ('value', 0.00027965293170846816), ('type', 0.0002365248648136166), ('sb', 0.00023199907892552306), ('result', 0.00022451584878670043), ('service', 0.00011941264758641571)]
// permissions          No	: [('execute', 0.010151481583652106), ('i', 0.006083639409202988), ('cfs', 0.005068962256965817), ('value', 0.002634907092749754), ('name', 0.0025632920004494547), ('e', 0.002522868279954984), ('metadata', 0.0024306739168789638), ('sstable', 0.0022607307776156445), ('keyspace', 0.00221935986422514), ('key', 0.00219491397021435)]
// resource             0	: [('resource', 0.5694885613716163), ('row', 0.00833264639535867), ('i', 0.001197202889546375), ('version', 0.0009433901922713435), ('map', 0.0008960728007554306), ('cfs', 0.0008204649084767461), ('list', 0.0007396358963255117), ('set', 0.0007251697822635238), ('e', 0.0006402024270230983), ('bytes', 0.0006362666743236839)]
// role                 1	: [('grantee', 0.8142643960382987), ('role', 0.025715050155693493), ('permission', 0.025705207466149616), ('user', 0.01285520866928998), ('perm', 0.01285481714684713), ('state', 0.004502895549651229), ('row', 0.0020831615988396676), ('i', 0.00029930072238659375), ('version', 0.00023584754806783587), ('map', 0.00022401820018885766)]

        return details;
// details              No	: [('builder', 0.058131034509567865), ('result', 0.04252981854192711), ('ret', 0.03235212997909826), ('sb', 0.02020422247707059), ('size', 0.01601352455795767), ('row', 0.011614698686017638), ('map', 0.008991581781094767), ('node', 0.00882577317752959), ('value', 0.008132844242645054), ('bytes', 0.007721596451764871)]
    }

    private Set<PermissionDetails> listPermissionsForRole(Set<Permission> permissions,
// permissions          0	: [('permissions', 0.7056446979029727), ('perms', 0.04112548416923507), ('getPermissions', 0.027420207847071658), ('ALL', 0.01371096075615943), ('NONE', 0.013710534405508023), ('AGGREGATE_FUNCTION_PERMISSIONS', 0.013708699144057167), ('KEYSPACE_LEVEL_PERMISSIONS', 0.013708699144057167), ('TABLE_LEVEL_PERMISSIONS', 0.013708690987339607), ('SCALAR_FUNCTION_PERMISSIONS', 0.013708690987339607), ('entry', 0.0003775781408194497)]
                                                          IResource resource,
// resource             0	: [('resource', 0.94328816341862), ('droppedResource', 0.0017364789179610217), ('r', 0.0011630607672357858), ('fromName', 0.0005791857045994454), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05), ('index', 1.0115084333350518e-05), ('id', 6.917651050079855e-06), ('right', 5.588106087903533e-06)]
                                                          RoleResource role)
// role                 5	: [('grantee', 0.3985371218101741), ('revokee', 0.20045877178928545), ('from', 0.09752944517668179), ('of', 0.09752883342286485), ('to', 0.09752752834805535), ('role', 0.045581201699496914), ('primaryRole', 0.002360368488383909), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05)]
    throws RequestExecutionException
    {
        Set<PermissionDetails> details = new HashSet<>();
// details              2	: [('allPerms', 0.519073799757601), ('list', 0.07636699777697288), ('details', 0.015421559899059424), ('entry', 0.0003775781408194497), ('sstables', 0.0003725425961112794), ('range', 0.00036134212563082796), ('type', 0.00028243466848158587), ('ranges', 0.00027481629428114), ('tokens', 0.00024584259166998793), ('options', 0.0002441490998228364)]
        for (UntypedResultSet.Row row : process(buildListQuery(resource, role)))
// row                  0	: [('row', 0.7651952422571149), ('r', 0.10587884995450994), ('actual', 0.021035942052908412), ('r1', 0.00473139223072311), ('r2', 0.004731245409807041), ('staticRow', 0.002248022562288473), ('row1', 0.0016050310203803697), ('row2', 0.001605014706945251), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05)]
// resource             No	: [('execute', 0.010151481583652106), ('i', 0.006083639409202988), ('cfs', 0.005068962256965817), ('value', 0.002634907092749754), ('name', 0.0025632920004494547), ('e', 0.002522868279954984), ('metadata', 0.0024306739168789638), ('sstable', 0.0022607307776156445), ('keyspace', 0.00221935986422514), ('key', 0.00219491397021435)]
// role                 6	: [('state', 0.2055115821986049), ('r', 0.0685655347364721), ('callback', 0.06848096940177059), ('pd', 0.06846695401459227), ('isSuper', 0.06845663771832385), ('grantee', 0.02978485688046744), ('role', 0.011951109713683048), ('permission', 0.011911738955507551), ('row', 0.00833264639535867), ('user', 0.005966289222614463)]
        {
            if (row.has(PERMISSIONS))
// row                  No	: [('logger', 0.02339687694414892), ('i', 0.01725676422722401), ('sstable', 0.01708571136345112), ('type', 0.015517086416777652), ('f', 0.015514706455236229), ('entry', 0.012570975073782494), ('current', 0.011523634672074182), ('str', 0.009766640219972544), ('holder', 0.008772072697320919), ('file', 0.007526711077084755)]
// PERMISSIONS          No	: [('row', 0.19451181082712798), ('columnName', 0.1444251342501116), ('indexName', 0.05827734393993621), ('expression', 0.01942970527672837), ('SALTED_HASH', 0.019420310365250555), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868), ('cfs', 0.0003168101410603636), ('value', 0.00016468169329685964), ('e', 0.0001576792674971865)]
            {
                for (String p : row.getSet(PERMISSIONS, UTF8Type.instance))
// p                    No	: [('name', 0.10418110543147564), ('table', 0.07159408730949236), ('filePath', 0.03759470441540363), ('keyspace', 0.034650615124329806), ('query', 0.0341439992060284), ('ks', 0.032644422165985745), ('m', 0.030993885625517793), ('message', 0.016120859920189017), ('path', 0.016113773300788933), ('k', 0.015345137353835565)]
// row                  8	: [('params', 0.05582587460729431), ('permissions', 0.05563748746164755), ('pairs', 0.055634746804547615), ('listResult', 0.05563396375966192), ('perTableBuilders', 0.05559636139248932), ('cfs', 0.003549229579012865), ('sstables', 0.0035143022120954306), ('values', 0.0018308744368121241), ('row', 0.0015956845496901402), ('ranges', 0.0014778362943924498)]
// PERMISSIONS          No	: [('i', 0.39451045492615033), ('name', 0.1940704115000562), ('s', 0.19384753864982343), ('execute', 0.0012689351979565133), ('cfs', 0.0006336202821207272), ('value', 0.0003293633865937193), ('e', 0.000315358534994373), ('metadata', 0.00030383423960987047), ('key', 0.00027436424627679375), ('put', 2.70389305368597e-05)]
// instance             0	: [('instance', 0.7531336566337866), ('cassandra', 0.011654820533747279), ('get', 0.0034708971123600454), ('size', 0.002483063662000674), ('db', 0.0024155168236639716), ('add', 0.0023381697983567607), ('format', 0.0016039769020990786), ('utils', 0.0012407354362760491), ('put', 0.0011458704099809353), ('key', 0.00014235170537985712)]
                {
                    Permission permission = Permission.valueOf(p);
// permission           1	: [('perm', 0.06771695890003183), ('permission', 0.0520931334673604), ('required', 0.010428032890465129), ('p', 0.005263028040807137), ('requiredPermission', 0.005214479257893802), ('key', 0.00023127132919891413), ('put', 0.00021391383423258767), ('result', 0.00017450057498574113), ('index', 0.0001618413493336083), ('id', 0.00011068241680127768)]
// p                    No	: [('i', 0.10930703665106274), ('j', 0.03890415852454344), ('r', 0.03685990714832907), ('value', 0.03582233035954397), ('row', 0.017614452167742434), ('options', 0.015504664577307287), ('args', 0.01520016532047784), ('stx', 0.015109910966303985), ('sty', 0.015099121721023685), ('optionValue', 0.012961324395942784)]
                    if (permissions.contains(permission))
// permissions          No	: [('t', 0.2522256946554304), ('startKey', 0.25023108075080597), ('value', 0.007613619700876454), ('flush', 0.006902866052424975), ('logger', 0.00608842582974079), ('i', 0.005318729230975429), ('options', 0.004783564131217972), ('size', 0.00413072076038556), ('version', 0.004077455706961457), ('cmd', 0.003647447512005919)]
// contains             No	: [('cassandra', 0.046619282134989115), ('get', 0.013883588449440182), ('instance', 0.012534626535146629), ('size', 0.009932254648002696), ('db', 0.009662067294655886), ('add', 0.009352679193427043), ('format', 0.006415907608396314), ('utils', 0.0049629417451041965), ('put', 0.004583481639923741), ('build', 0.00437491330280743)]
// permission           No	: [('hosts', 0.0691139813744463), ('reader', 0.030389618989376824), ('endpoint', 0.02363660922764175), ('sstable', 0.0196723912752967), ('replica', 0.011755009033432304), ('name', 0.010609801390143387), ('token', 0.010185374095076931), ('column', 0.009797856130386709), ('range', 0.009454510776568245), ('r', 0.009350854227611758)]
                        details.add(new PermissionDetails(row.getString(ROLE),
// details              No	: [('logger', 0.004059650300007188), ('service', 0.0015069322736863903), ('builder', 0.0014804648467337596), ('sb', 0.0011630977753873482), ('size', 0.0009797797136865559), ('r', 0.0007461441757699203), ('tokens', 0.0004728670192833881), ('original', 0.00046623413636406874), ('flags', 0.00036658744563148005), ('state', 0.000365463206989917)]
// add                  1	: [('resource', 0.12500761054385404), ('add', 0.0983913071214006), ('permission', 0.027780788721427217), ('isEmpty', 0.014287819036682553), ('cassandra', 0.005827410266873639), ('get', 0.0017354485561800227), ('instance', 0.0015668283168933286), ('size', 0.001241531831000337), ('db', 0.0012077584118319858), ('key', 7.117585268992856e-05)]
// row                  No	: [('entry', 0.33358080288846165), ('grantee', 0.3333538959497882), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746), ('metadata', 0.0006076684792197409), ('sstable', 0.0005651826944039111)]
// ROLE                 No	: [('i', 0.10409158270320741), ('ITEM_NAMES', 0.10248181587451863), ('name', 0.05668363565475296), ('key', 0.02240531356393171), ('value', 0.01253586582707092), ('partition', 0.00869516969139701), ('cell', 0.006215782011107913), ('bytes', 0.005056232850916708), ('index', 0.005013434068017857), ('execute', 0.0006344675989782566)]
                                                          Resources.fromName(row.getString(RESOURCE)),
// fromName             No	: [('chain', 0.3333388527852154), ('cassandra', 0.023309641067494558), ('get', 0.006941794224720092), ('instance', 0.006267313267573314), ('size', 0.004966127324001348), ('db', 0.004831033647327943), ('add', 0.004676339596713521), ('format', 0.0032079538041981572), ('utils', 0.0024814708725520982), ('put', 0.0022917408199618705)]
// row                  No	: [('name', 0.2915499139092033), ('options', 0.07314187955275335), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('e', 0.000630717069988746), ('metadata', 0.0006076684792197409), ('sstable', 0.0005651826944039111), ('key', 0.0005487284925535875)]
// RESOURCE             No	: [('i', 0.10409158270320741), ('ITEM_NAMES', 0.10248181587451863), ('name', 0.05668363565475296), ('key', 0.02240531356393171), ('value', 0.01253586582707092), ('partition', 0.00869516969139701), ('cell', 0.006215782011107913), ('bytes', 0.005056232850916708), ('index', 0.005013434068017857), ('execute', 0.0006344675989782566)]
                                                          permission));
// permission           No	: [('row', 0.2556281393723788), ('range', 0.023104835796509952), ('set', 0.018531331628471506), ('ranges', 0.010810327899817375), ('e', 0.00770807982869975), ('digest1', 0.007066130188962381), ('iFunc', 0.006462640447710469), ('bounds', 0.00595012411151524), ('mt', 0.005481651838522804), ('verify', 0.0053944674145836435)]
                }
            }
        }
        return details;
// details              No	: [('results', 0.053133729185670345), ('builder', 0.042481060434078906), ('optionsBuilder', 0.040972610296401146), ('sb', 0.038350487396540435), ('result', 0.028062846884643656), ('size', 0.021524421030258367), ('values', 0.018351518302318983), ('strategy', 0.017690696998351164), ('executor', 0.017666561709208328), ('metrics', 0.017649296439231948)]
    }

    private String buildListQuery(IResource resource, RoleResource grantee)
// resource             0	: [('resource', 0.3888978999415523), ('droppedResource', 0.16389183134368818), ('r', 0.10930448613788629), ('fromName', 0.004633485636795563), ('key', 0.00011563566459945706), ('put', 0.00010695691711629383), ('result', 8.725028749287057e-05), ('index', 8.092067466680414e-05), ('id', 5.534120840063884e-05), ('right', 4.4704848703228265e-05)]
// grantee              0	: [('grantee', 0.35262979917590376), ('revokee', 0.1786953213563487), ('role', 0.09116240339899383), ('from', 0.08394777924225247), ('of', 0.08394655573461857), ('to', 0.08394394558499957), ('primaryRole', 0.004720736976767818), ('key', 2.8908916149864266e-05), ('put', 2.673922927907346e-05), ('result', 2.1812571873217642e-05)]
    {
        List<String> vars = Lists.newArrayList(SchemaConstants.AUTH_KEYSPACE_NAME, AuthKeyspace.ROLE_PERMISSIONS);
// vars                 No	: [('keyspaces', 0.07389183221089683), ('mvPrimaryKeys', 0.05682598943065204), ('targetHosts', 0.05075921338737315), ('names', 0.04328769486313746), ('traces', 0.0355643090771879), ('records', 0.025667795463415494), ('indexes', 0.01711543240765987), ('seedList', 0.017048015957418023), ('ret', 0.012041008797560574), ('queryStrings', 0.011365469292801172)]
// AUTH_KEYSPACE_NAME   2	: [('SYSTEM_KEYSPACE_NAME', 0.3267430070618026), ('SCHEMA_KEYSPACE_NAME', 0.1456055550478382), ('AUTH_KEYSPACE_NAME', 0.09492020077435766), ('DISTRIBUTED_KEYSPACE_NAME', 0.04733596911584335), ('LOCAL_SYSTEM_KEYSPACE_NAMES', 0.017074629440667607), ('TRACE_KEYSPACE_NAME', 0.016040976280462586), ('LEGACY_AUTH_TABLES', 0.013973539452571591), ('cassandra', 0.011654820533747279), ('get', 0.0034708971123600454), ('instance', 0.003133656633786657)]
// ROLE_PERMISSIONS     No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
        List<String> conditions = new ArrayList<>();
// conditions           No	: [('queries', 0.031948369627972276), ('warnings', 0.029004985972916175), ('hosts', 0.028730213176345772), ('keyspaces', 0.023745150876096677), ('tokens', 0.01816190048813292), ('keys', 0.017080780543012937), ('actualRecords', 0.016817463156186402), ('sstables', 0.01645319956899153), ('failedDirectories', 0.016085436011227177), ('argTypes', 0.013715572244115794)]

        if (resource != null)
// resource             No	: [('logger', 0.01731933328706334), ('size', 0.015810864516001017), ('next', 0.010073084646910037), ('i', 0.00981109221390445), ('state', 0.009535186261878851), ('type', 0.007315852827404566), ('savedEndpoints', 0.005738470073520909), ('length', 0.005659191963991141), ('buffer', 0.005137440082548159), ('args', 0.004913926767305644)]
        {
            conditions.add("resource = '%s'");
// conditions           No	: [('resource', 0.500925503360571), ('logger', 0.027124976064476718), ('out', 0.01899164309501183), ('sb', 0.0071987162418368006), ('builder', 0.006472342444670662), ('statsTable', 0.006466634816583128), ('result', 0.005697229503752621), ('writer', 0.003996950086903682), ('bb', 0.0037181116836591246), ('ret', 0.003706490553131655)]
// add                  No	: [('isEmpty', 0.11017286029558733), ('size', 0.03373306366200067), ('put', 0.03239587040998093), ('values', 0.03155766210480358), ('get', 0.019095897112360045), ('cassandra', 0.011654820533747279), ('instance', 0.003133656633786657), ('db', 0.0024155168236639716), ('key', 0.00014235170537985712)]
            vars.add(escape(resource.getName()));
// vars                 No	: [('records', 0.21478607715516312), ('execute', 0.18934208747473247), ('add', 0.14330436587114326), ('params', 0.07205391320816158), ('args', 0.07160126531739103), ('flush', 0.010019534845323275), ('cfs', 0.004393449961191497), ('sb', 0.0025056433825459967), ('fail', 0.002108372833859333), ('header', 0.0020015733907926287)]
// add                  5	: [('cassandra', 0.046619282134989115), ('get', 0.013883588449440182), ('instance', 0.012534626535146629), ('size', 0.009932254648002696), ('db', 0.009662067294655886), ('add', 0.009352679193427043), ('format', 0.006415907608396314), ('utils', 0.0049629417451041965), ('put', 0.004583481639923741), ('build', 0.00437491330280743)]
// resource             No	: [('comparator', 0.514822431393481), ('role', 0.13241255910736474), ('grantee', 0.029432327322337238), ('revokee', 0.014710350592918683), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]
        }

        if (grantee != null)
// grantee              No	: [('cmd', 0.033371712568538305), ('conf', 0.027866839498668132), ('i', 0.0216582873114981), ('logger', 0.01254165169611245), ('options', 0.011909856509346181), ('value', 0.01123867003080113), ('input', 0.010286348656380886), ('type', 0.009901938925687834), ('version', 0.008929331451591799), ('cqlType', 0.00765771606418233)]
        {
            conditions.add(ROLE + " = '%s'");
// conditions           No	: [('logger', 0.054249952128953435), ('out', 0.03798328619002366), ('sb', 0.014397432483673601), ('builder', 0.012944684889341324), ('statsTable', 0.012933269633166256), ('result', 0.011394459007505242), ('writer', 0.007993900173807364), ('bb', 0.007436223367318249), ('totalSize', 0.007413841171570872), ('ret', 0.00741298110626331)]
// add                  No	: [('isEmpty', 0.11017286029558733), ('size', 0.03373306366200067), ('put', 0.03239587040998093), ('values', 0.03155766210480358), ('get', 0.019095897112360045), ('cassandra', 0.011654820533747279), ('instance', 0.003133656633786657), ('db', 0.0024155168236639716), ('key', 0.00014235170537985712)]
// ROLE                 No	: [('sstable', 0.013275404711055159), ('rt', 0.012366935367449696), ('i', 0.007899031961458934), ('replica', 0.006676569397699227), ('range', 0.00581466171429112), ('value', 0.00536432344293767), ('r', 0.005051199429904476), ('t', 0.004939456798480909), ('row', 0.00476737678280823), ('tokenizer', 0.004649193116325641)]
            vars.add(escape(grantee.getRoleName()));
// vars                 No	: [('execute', 0.029709754237026837), ('i', 0.011300362853893827), ('cfs', 0.00531566691642273), ('builder', 0.004736016419182373), ('out', 0.004542927535051217), ('logger', 0.004348713434819111), ('sb', 0.003069443735559788), ('flush', 0.002756297030763046), ('put', 0.002499951622929456), ('options', 0.0020175897366003508)]
// add                  5	: [('cassandra', 0.046619282134989115), ('get', 0.013883588449440182), ('instance', 0.012534626535146629), ('size', 0.009932254648002696), ('db', 0.009662067294655886), ('add', 0.009352679193427043), ('format', 0.006415907608396314), ('utils', 0.0049629417451041965), ('put', 0.004583481639923741), ('build', 0.00437491330280743)]
// grantee              2	: [('comparator', 0.514822431393481), ('role', 0.13241255910736474), ('grantee', 0.029432327322337238), ('revokee', 0.014710350592918683), ('execute', 0.0025378703959130266), ('i', 0.001520909852300747), ('cfs', 0.0012672405642414543), ('value', 0.0006587267731874385), ('name', 0.0006408230001123637), ('e', 0.000630717069988746)]
        }

        String query = "SELECT " + ROLE + ", resource, permissions FROM %s.%s";
// query                2	: [('str', 0.05466443406174446), ('id', 0.05271194825196137), ('query', 0.0460688484147506), ('ks', 0.04570998791368947), ('req', 0.045627970180895476), ('versionString', 0.04555713000606454), ('formatstr', 0.045554959605467064), ('maxThreshold', 0.045550765625188186), ('colCount', 0.04555069221473015), ('logAll', 0.045550659587859914)]
// ROLE                 No	: [('fName', 0.5282662456040425), ('a', 0.029889240142879067), ('fList', 0.011524476884139137), ('typeDef', 0.008330361664141644), ('aggregation', 0.00823239463682649), ('KEYSPACE', 0.006875239355137432), ('fTup2', 0.006586059871338028), ('fTup1', 0.006586059871338028), ('fTup4', 0.006586059871338028), ('fName1', 0.006586059871338028)]

        if (!conditions.isEmpty())
// conditions           No	: [('row', 0.25197618765948393), ('frozen', 0.25091401381113054), ('matcher', 0.005514430872739033), ('dir', 0.004665794629179738), ('isEmpty', 0.003981679033459687), ('options', 0.003798625590386394), ('type', 0.0030675509496820423), ('result', 0.0030045976151697623), ('deletion', 0.0029260159071406474), ('components', 0.0026286617272209055)]
// isEmpty              0	: [('isEmpty', 0.8712932150738968), ('size', 0.008433265915500168), ('put', 0.008098967602495233), ('values', 0.007889415526200896), ('get', 0.004773974278090011), ('cassandra', 0.0029137051334368197), ('instance', 0.0007834141584466643), ('db', 0.0006038792059159929), ('key', 3.558792634496428e-05)]
            query += " WHERE " + StringUtils.join(conditions, " AND ");
// query                No	: [('sb', 0.020415716677781335), ('logger', 0.011596133025186589), ('mapping', 0.006626528538194926), ('n', 0.005078902789384469), ('elementsList', 0.004969963533218909), ('observers', 0.004969801806816056), ('builder', 0.003933425206835657), ('m', 0.0033419643813930046), ('request', 0.0033146695682338225), ('indexName', 0.003314452152756387)]
// join                 0	: [('join', 0.43777432530666077), ('replace', 0.17064190836585083), ('EMPTY', 0.051235556613186704), ('split', 0.021786000134463843), ('isEmpty', 0.014577387854642448), ('cassandra', 0.011654820533747279), ('remove', 0.006223699112953605), ('get', 0.0034708971123600454), ('instance', 0.003133656633786657), ('size', 0.002483063662000674)]
// conditions           No	: [('mutation', 0.2562477401009926), ('pb', 0.25622061154525805), ('replicas', 0.031129758182051985), ('directory', 0.018676598190620047), ('tokenMetadata', 0.018669386949706147), ('cfnames', 0.013661128619231825), ('correct', 0.01244052295553822), ('args', 0.00990660575763803), ('s', 0.006268539041280528), ('path', 0.006245173297153503)]

        if (resource != null && grantee == null)
// resource             No	: [('end', 0.5002533137842895), ('value', 0.007613619700876454), ('flush', 0.006902866052424975), ('logger', 0.00608842582974079), ('i', 0.005318729230975429), ('options', 0.004783564131217972), ('size', 0.00413072076038556), ('version', 0.004077455706961457), ('cmd', 0.003647447512005919), ('cmp', 0.00344373099778875)]
// grantee              No	: [('recursive', 0.7504775947761382), ('value', 0.005408758036356396), ('comparator', 0.0034182663155349117), ('current', 0.0028798160881657996), ('prev', 0.00241217468056942), ('cfs', 0.0021556310999357206), ('cell', 0.0020564480482061337), ('session', 0.0019514664828984996), ('result', 0.0015497058191094204), ('message', 0.0015003601603545257)]
            query += " ALLOW FILTERING";
// query                No	: [('savedEndpoints', 0.0093151720542872), ('params', 0.0077660156273045506), ('logger', 0.007302820434803533), ('conf', 0.005955034139107932), ('builder', 0.0058891980718377875), ('t', 0.004604520632490535), ('sb', 0.004332317790573977), ('next', 0.003971658137817522), ('current', 0.002676106861405087), ('keyspace', 0.0026219910938262234)]

        return String.format(query, vars.toArray());
// format               0	: [('format', 0.8415435763990372), ('join', 0.023568454026278666), ('cassandra', 0.005827410266873639), ('get', 0.0017354485561800227), ('instance', 0.0015668283168933286), ('size', 0.001241531831000337), ('db', 0.0012077584118319858), ('add', 0.0011690848991783803), ('utils', 0.0006203677181380246), ('key', 7.117585268992856e-05)]
// query                1	: [('template', 0.013496880988912136), ('query', 0.0057144775084983935), ('req', 0.00393579004945077), ('clusteringInsert', 0.0024753449453761), ('format', 0.0019385734012669755), ('clusteringDelete', 0.0014441078696225042), ('schema', 0.001247195471663943), ('frozen', 0.0012401837216551265), ('clusteringConditionalUpdate', 0.0012378522977542256), ('execute', 0.0006344675989782566)]
// vars                 No	: [('name', 0.1360912696559915), ('keyspace', 0.11798191360239996), ('KEYSPACE', 0.10883604865821958), ('KEYSPACE1', 0.08158410713901919), ('currentKeyspace', 0.0815714233652275), ('cfs', 0.030438165723228387), ('args', 0.028226306035270647), ('functionName', 0.02720814798913688), ('aggregateName', 0.027198482200842162), ('TRANSFERRED_RANGES_V2', 0.027190614471159887)]
    }


    public Set<DataResource> protectedResources()
    {
        return ImmutableSet.of(DataResource.table(SchemaConstants.AUTH_KEYSPACE_NAME, AuthKeyspace.ROLE_PERMISSIONS));
// of                   1	: [('copyOf', 0.5613240851808272), ('of', 0.3712246974830803), ('cassandra', 0.0029137051334368197), ('builder', 0.0020413901387270695), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('format', 0.00040099422552476965)]
// table                0	: [('table', 0.6862894603761863), ('keyspace', 0.22640325934575023), ('root', 0.02124695646269815), ('fromName', 0.0036784408615444185), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902)]
// AUTH_KEYSPACE_NAME   0	: [('AUTH_KEYSPACE_NAME', 0.4737300501935894), ('SYSTEM_KEYSPACE_NAME', 0.23168575176545064), ('SCHEMA_KEYSPACE_NAME', 0.18640138876195955), ('DISTRIBUTED_KEYSPACE_NAME', 0.011833992278960837), ('LOCAL_SYSTEM_KEYSPACE_NAMES', 0.004268657360166902), ('TRACE_KEYSPACE_NAME', 0.004010244070115646), ('LEGACY_AUTH_TABLES', 0.003493384863142898), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643)]
// ROLE_PERMISSIONS     No	: [('ROLES', 0.5710902336810919), ('ROLE_MEMBERS', 0.2088339702460431), ('NETWORK_PERMISSIONS', 0.12708641032810009), ('GENERATION', 0.013187941443304907), ('metadata', 0.010965336673747883), ('SUPERUSER_SETUP_DELAY', 0.006593915070780283), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
    }

    public void validateConfiguration() throws ConfigurationException
    {
    }

    public void setup()
// setup                0	: [('setup', 0.5280137844267287), ('close', 0.057871348267549756), ('onChange', 0.031893151830759685), ('rangeTombstone', 0.021217211599655558), ('commit', 0.016268258885012998), ('partitionDelete', 0.01611515446989391), ('write', 0.01302962970911359), ('warn', 0.011379469215558052), ('setupTask', 0.010518801607096246), ('key', 1.4454458074932133e-05)]
    {
        authorizeRoleStatement = prepare(ROLE, AuthKeyspace.ROLE_PERMISSIONS);
// authorizeRoleStatement No	: [('cfs', 0.05861175289789539), ('ks', 0.058375130490852696), ('metadata', 0.03895787642492758), ('nowInSeconds', 0.03888378330232833), ('data', 0.019485715576043942), ('encryptionContext', 0.019466136462340942), ('handler', 0.01946229723835541), ('compressor', 0.019448011134562893), ('encryptionOptions', 0.019442002144131085), ('loadRoleStatement', 0.01944143933061949)]
// ROLE                 No	: [('query', 0.3395636042965443), ('settings', 0.16828590987127093), ('keyspace', 0.02925574631046716), ('metadata', 0.01722398267861551), ('table', 0.015376712272019121), ('cfm', 0.01451746762328209), ('keyspaceName', 0.009323389247171633), ('cql', 0.007687214774870402), ('state', 0.00322279172598602), ('execute', 0.0025378703959130266)]
// ROLE_PERMISSIONS     No	: [('ROLES', 0.40990206026549314), ('ROLE_MEMBERS', 0.13187267752096898), ('NETWORK_PERMISSIONS', 0.08626771923447828), ('GENERATION', 0.052751765773219626), ('metadata', 0.04386134669499153), ('SUPERUSER_SETUP_DELAY', 0.026375660283121133), ('cassandra', 0.011654820533747279), ('get', 0.0034708971123600454), ('instance', 0.003133656633786657), ('size', 0.002483063662000674)]
    }

    private SelectStatement prepare(String entityname, String permissionsTable)
// entityname           No	: [('query', 0.5340467255295196), ('keyspace', 0.13506701997700146), ('name', 0.013011909531202036), ('ksName', 0.0066089681898842305), ('keyspaceName', 0.005839211184210471), ('queryString', 0.003944008862425021), ('template', 0.0038529341717594033), ('key', 0.001905442202008062), ('result', 5.8496880380605145e-05), ('put', 2.673922927907346e-05)]
// permissionsTable     No	: [('name', 0.025796332205801863), ('keyspace', 0.023334268671999447), ('table', 0.017958149940354242), ('cfName', 0.016669975867677832), ('keyspaceName', 0.014306327418934311), ('query', 0.01216938699182589), ('message', 0.010763251231946014), ('key', 0.008672444830637907), ('description', 0.007132779946865544), ('cf', 0.006966958377043809)]
    {
        String query = String.format("SELECT permissions FROM %s.%s WHERE %s = ? AND resource = ?",
// query                0	: [('query', 0.05543088174240562), ('keyspaceName', 0.035120007961806025), ('key', 0.02841254338680217), ('name', 0.02708596261466468), ('req', 0.024110648654428368), ('message', 0.02390128223378677), ('keyspace', 0.022973898692410146), ('cql', 0.01841714330393971), ('table', 0.017988229927102174), ('msg', 0.01739559277045548)]
// format               0	: [('format', 0.9277248519164909), ('cassandra', 0.0029137051334368197), ('join', 0.002229349690900451), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685), ('db', 0.0006038792059159929), ('add', 0.0005845424495891902), ('utils', 0.0003101838590690123), ('key', 3.558792634496428e-05)]
                                     SchemaConstants.AUTH_KEYSPACE_NAME,
// AUTH_KEYSPACE_NAME   1	: [('SCHEMA_KEYSPACE_NAME', 0.5282260224615933), ('AUTH_KEYSPACE_NAME', 0.22450385971739895), ('SYSTEM_KEYSPACE_NAME', 0.12527320597790487), ('NAME_LENGTH', 0.030713540773412356), ('DISTRIBUTED_KEYSPACE_NAME', 0.015931977626946186), ('TRACE_KEYSPACE_NAME', 0.002957130517002094), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
                                     permissionsTable,
// permissionsTable     No	: [('legacyTable', 0.07727024462189609), ('legacyAuthTable', 0.03863515658836672), ('name', 0.014967880380501748), ('NETWORK_PERMISSIONS', 0.0037888450987537963), ('row', 0.0020831615988396676), ('DISTRIBUTED_KEYSPACE_NAME', 0.0018947124901301253), ('i', 0.00029930072238659375), ('version', 0.00023584754806783587), ('map', 0.00022401820018885766), ('cfs', 0.00020511622711918653)]
                                     entityname);
// entityname           No	: [('row', 0.03333058558143468), ('i', 0.0047888115581855), ('version', 0.0037735607690853735), ('map', 0.003584291203021723), ('cfs', 0.0032818596339069844), ('list', 0.002958543585302047), ('set', 0.0029006791290540953), ('e', 0.002560809708092393), ('bytes', 0.0025450666972947357), ('key', 0.00247667187968421)]
        return (SelectStatement) QueryProcessor.getStatement(query, ClientState.forInternalCalls());
// getStatement         0	: [('getStatement', 0.7844382759525217), ('metrics', 0.0288512177663164), ('instance', 0.016308891865453035), ('cassandra', 0.0029137051334368197), ('preparedStatementsCount', 0.001991863614129449), ('CQL_VERSION', 0.001593939582831384), ('get', 0.0008677242780900114), ('size', 0.0006207659155001685), ('execute', 0.0005086321812650036), ('key', 3.558792634496428e-05)]
// query                0	: [('query', 0.4919635583901585), ('cql', 0.30198942052438416), ('s', 0.02559956491854697), ('key', 0.016202053604166548), ('message', 0.008117644168199826), ('statement', 0.008046809336625422), ('mock', 0.008036753731025298), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868), ('cfs', 0.0003168101410603636)]
    }

    // We only worry about one character ('). Make sure it's properly escaped.
    private String escape(String name)
// name                 0	: [('name', 0.388011909531202), ('input', 0.375655289101156), ('keyspace', 0.011932691618792493), ('keyspaceName', 0.005839211184210471), ('query', 0.004195979260862898), ('ksName', 0.0028776249063021406), ('s', 0.0023116945251501326), ('value', 0.0020564160857701264), ('msg', 0.0019998308138712566), ('key', 0.001905442202008062)]
    {
        return StringUtils.replace(name, "'", "''");
// replace              2	: [('join', 0.48714920903229286), ('remove', 0.2623784356007492), ('replace', 0.13140506583605144), ('EMPTY', 0.012808889153296676), ('split', 0.005446500033615961), ('isEmpty', 0.003644346963660612), ('cassandra', 0.0029137051334368197), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('size', 0.0006207659155001685)]
// name                 0	: [('name', 0.6294340222316178), ('deserialize', 0.12928077678106942), ('key', 0.017232448049497254), ('K', 0.008644144710260745), ('a', 0.008587831205086825), ('f', 0.004322358350830684), ('b', 0.004317426796249586), ('removed', 0.004277556510025217), ('dependentType', 0.004274650153761422), ('execute', 0.0006344675989782566)]
    }

    ResultMessage.Rows select(SelectStatement statement, QueryOptions options)
// select               1	: [('rows', 0.19788419904718144), ('select', 0.08994119837110157), ('execute', 0.05411511052562904), ('msg', 0.018006017207716843), ('resp', 0.017988920727712413), ('rowMsg', 0.001749820856262103), ('key', 5.781783229972853e-05), ('put', 5.347845855814692e-05), ('result', 4.3625143746435284e-05), ('index', 4.046033733340207e-05)]
// statement            0	: [('statement', 0.8987745571237424), ('select', 0.019755737488213288), ('selectStatement', 0.0011164718622915766), ('ss', 0.0005592355063266801), ('stmt', 0.0005590479018228147), ('authenticateStatement', 0.0005584198345707437), ('authorizeUserStatement', 0.000558403521135625), ('loadRoleStatement', 0.000558403521135625), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05)]
// options              0	: [('options', 0.9050598692131301), ('queryOptions', 0.00211559468777316), ('wrapped', 0.00033556078013267015), ('b', 0.00019815746390776617), ('statementOptions', 9.58529079186298e-05), ('largeOptions', 9.579581089571425e-05), ('DEFAULT', 4.869764104854441e-05), ('key', 1.4454458074932133e-05), ('put', 1.336961463953673e-05), ('result', 1.0906285936608821e-05)]
    {
        return statement.execute(QueryState.forInternalCalls(), options, System.nanoTime());
// statement            0	: [('statement', 0.1700878806398789), ('partitionKeyRestrictions', 0.06811879767392459), ('options', 0.05390666461679548), ('bytes', 0.03513458477688223), ('execute', 0.03419617726761611), ('clusteringColumnsRestrictions', 0.03404890364359701), ('conf', 0.00488043193993522), ('delegate', 0.004766054406669709), ('type', 0.0025861237019696314), ('row', 0.0024027495010521672)]
// execute              0	: [('execute', 0.3313605430092905), ('bind', 0.042517860286353286), ('log', 0.013763201977049949), ('validate', 0.01003473111182985), ('metadata', 0.005251050959462168), ('statement', 0.0037592305755139027), ('hasConditions', 0.003751680775544007), ('cassandra', 0.0029137051334368197), ('builder', 0.0025882651387270695), ('get', 0.0008677242780900114)]
// options              0	: [('options', 0.751520190001056), ('row', 0.024956087390336494), ('cfs', 0.0027374147761781444), ('key', 0.002687627734123631), ('e', 0.0025015006346947514), ('sstable', 0.002073924755728764), ('entry', 0.0018782230308378508), ('metadata', 0.0018706004304549755), ('version', 0.0015438953629222404), ('out', 0.0014397370471187386)]
// nanoTime             0	: [('nanoTime', 0.8064537060086525), ('currentTimeMillis', 0.08936761636840997), ('out', 0.02602816462762908), ('err', 0.005452979744265908), ('cassandra', 0.0029137051334368197), ('gc', 0.0009365415945840366), ('get', 0.0008677242780900114), ('instance', 0.0007834141584466643), ('in', 4.960855754169982e-05), ('console', 4.10565677219081e-05)]
    }

    UntypedResultSet process(String query) throws RequestExecutionException
// query                0	: [('query', 0.7995117827338797), ('input', 0.01756902386092282), ('queryString', 0.008727022444593878), ('name', 0.006505954765601018), ('keyspace', 0.005966345809396247), ('keyspaceName', 0.0029196055921052355), ('ksName', 0.0014388124531510703), ('s', 0.0011558472625750663), ('value', 0.0010282080428850632), ('key', 0.000952721101004031)]
    {
        return QueryProcessor.process(query, ConsistencyLevel.LOCAL_ONE);
// query                0	: [('query', 0.5554765833216734), ('cql', 0.20771489882770058), ('format', 0.03200260047576591), ('defaultSUQuery', 0.03195164684277011), ('fmtQry', 0.01597651805207839), ('allUsersQuery', 0.015976003246451233), ('iter', 0.012253042572412746), ('message', 0.008226655796106803), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868)]
    }

    void processBatch(BatchStatement statement)
// statement            0	: [('statement', 0.7554869275306928), ('batch', 0.07873015980425326), ('batchStatement', 0.004386831033461473), ('b', 0.002203179862209034), ('bs', 0.001097683617953321), ('batchStmt', 0.001097210528334878), ('key', 2.8908916149864266e-05), ('put', 2.673922927907346e-05), ('result', 2.1812571873217642e-05), ('index', 2.0230168666701036e-05)]
    {
        QueryProcessor.instance.processBatch(statement,
// instance             1	: [('metrics', 0.28876304159323885), ('instance', 0.03261778373090607), ('getStatement', 0.006376551905043375), ('cassandra', 0.005827410266873639), ('preparedStatementsCount', 0.003983727228258898), ('CQL_VERSION', 0.003187879165662768), ('get', 0.0017354485561800227), ('size', 0.001241531831000337), ('execute', 0.0010172643625300072), ('key', 7.117585268992856e-05)]
// statement            0	: [('statement', 0.45455982814156587), ('batch', 0.44887007580068383), ('execute', 0.0006344675989782566), ('i', 0.0003802274630751868), ('cfs', 0.0003168101410603636), ('value', 0.00016468169329685964), ('name', 0.00016020575002809092), ('e', 0.0001576792674971865), ('metadata', 0.00015191711980493523), ('sstable', 0.00014129567360097778)]
                                             QueryState.forInternalCalls(),
                                             BatchQueryOptions.withoutPerStatementVariables(QueryOptions.DEFAULT),
// DEFAULT              0	: [('DEFAULT', 0.848407940005381), ('codec', 0.014270798522286125), ('cassandra', 0.005827410266873639), ('get', 0.0017354485561800227), ('instance', 0.0015668283168933286), ('size', 0.001241531831000337), ('db', 0.0012077584118319858), ('add', 0.0011690848991783803), ('format', 0.0008019884510495393), ('utils', 0.0006203677181380246)]
                                             System.nanoTime());
// nanoTime             1	: [('currentTimeMillis', 0.6066198481214353), ('nanoTime', 0.18502279663268964), ('out', 0.05205632925525816), ('err', 0.010905959488531815), ('cassandra', 0.005827410266873639), ('gc', 0.0018730831891680731), ('get', 0.0017354485561800227), ('instance', 0.0015668283168933286), ('in', 9.921711508339963e-05), ('console', 8.21131354438162e-05)]
    }
}
